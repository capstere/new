--- a/New folder/Modules/RuleEngine.ps1
+++ b/New folder/Modules/RuleEngine.ps1
@@ -32,6 +32,7 @@
         SampleIdMarkers = @()
         ParityCheckConfig = @()
         SampleNumberRules = @()
+        TestTypePolicy = @()
     }
 
     if (-not (Test-Path -LiteralPath $RuleBankDir)) { return [pscustomobject]$rb }
@@ -44,6 +45,7 @@
         SampleIdMarkers         = '05_SampleIdMarkers.csv'
         ParityCheckConfig       = '06_ParityCheckConfig.csv'
         SampleNumberRules       = '07_SampleNumberRules.csv'
+        TestTypePolicy           = '08_TestTypePolicy.csv'
     }
 
     foreach ($k in $map.Keys) {
@@ -57,9 +59,230 @@
     try { $rb.ParityCheckConfig = @($rb.ParityCheckConfig | Sort-Object { [int]($_.Priority) } -Descending) } catch {}
     try { $rb.SampleIdMarkers = @($rb.SampleIdMarkers | Sort-Object { [int]($_.Priority) } -Descending) } catch {}
     try { $rb.SampleNumberRules = @($rb.SampleNumberRules | Sort-Object { [int]($_.Priority) } -Descending) } catch {}
+    try { $rb.TestTypePolicy = @($rb.TestTypePolicy | Sort-Object { [int]($_.Priority) } -Descending) } catch {}
 
     return [pscustomobject]$rb
 }
+
+
+function Compile-RuleBank {
+    <#
+      Builds in-memory indexes and caches for one-shot performance.
+      IMPORTANT: Does not change rule semantics; it only memoizes and caches.
+      Populates: $RuleBank.Compiled
+        - RegexCache: pattern -> [regex]
+        - PatternsByAssay: assay -> object[] (ResultCallPatterns filtered by assay, in original priority order)
+        - ExpectRulesByAssay: assay -> object[] (SampleExpectationRules filtered by assay, in original priority order)
+        - MarkerByAssayType: "assay|markertype" -> marker string (memoized)
+        - PolicyByAssay: assay -> policy row (memoized, first match wins)
+        - SampleNumRuleByAssayCode: "assay|controlcode" -> rule row (memoized, first match wins)
+    #>
+    param([Parameter(Mandatory)][pscustomobject]$RuleBank)
+
+    $compiled = [ordered]@{
+        RegexCache = @{}
+        PatternsByAssay = @{}
+        ExpectRulesByAssay = @{}
+        MarkerByAssayType = @{}
+        PolicyByAssay = @{}
+        SampleNumRuleByAssayCode = @{}
+    }
+
+    # Precompile regexes for ResultCallPatterns
+    try {
+        foreach ($r in @($RuleBank.ResultCallPatterns)) {
+            if (-not $r) { continue }
+            if (-not (Test-RuleEnabled $r)) { continue }
+            $mt = ((Get-RowField -Row $r -FieldName 'MatchType') + '').Trim().ToUpperInvariant()
+            if ($mt -ne 'REGEX') { continue }
+            $pat = ((Get-RowField -Row $r -FieldName 'Pattern') + '')
+            if (-not ($pat.Trim())) { continue }
+            if (-not $compiled.RegexCache.ContainsKey($pat)) {
+                try {
+                    $compiled.RegexCache[$pat] = New-Object System.Text.RegularExpressions.Regex($pat, [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+                } catch {
+                    # Invalid regex: cache a regex that never matches to preserve "false" outcome deterministically
+                    $compiled.RegexCache[$pat] = New-Object System.Text.RegularExpressions.Regex('a\A', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+                }
+            }
+        }
+    } catch {}
+
+    try { $RuleBank | Add-Member -NotePropertyName 'Compiled' -NotePropertyValue ([pscustomobject]$compiled) -Force } catch { $RuleBank.Compiled = [pscustomobject]$compiled }
+    return $RuleBank
+}
+
+function Get-ResultCallPatternsForAssay {
+    <#
+      Returns ResultCallPatterns filtered for the given assay, memoized per assay.
+      Preserves original rule order (priority-sorted list from RuleBank).
+    #>
+    param(
+        [Parameter(Mandatory)][pscustomobject]$RuleBank,
+        [Parameter(Mandatory)][string]$Assay
+    )
+    $aKey = (($Assay + '').Trim())
+    if (-not $aKey) { $aKey = '(blank)' }
+
+    $c = $RuleBank.Compiled
+    if (-not $c) { return @($RuleBank.ResultCallPatterns) }
+
+    if ($c.PatternsByAssay.ContainsKey($aKey)) { return @($c.PatternsByAssay[$aKey]) }
+
+    $list = New-Object System.Collections.Generic.List[object]
+    foreach ($r in @($RuleBank.ResultCallPatterns)) {
+        if (-not $r) { continue }
+        if (-not (Test-RuleEnabled $r)) { continue }
+        $ruleAssay = (Get-RowField -Row $r -FieldName 'Assay')
+        if (-not (Test-AssayMatch -RuleAssay $ruleAssay -RowAssay $Assay)) { continue }
+        $list.Add($r)
+    }
+    $arr = $list.ToArray()
+    $c.PatternsByAssay[$aKey] = $arr
+    return @($arr)
+}
+
+function Get-ExpectationRulesForAssay {
+    <#
+      Returns SampleExpectationRules filtered for the given assay, memoized per assay.
+      Preserves original rule order (priority-sorted list from RuleBank).
+    #>
+    param(
+        [Parameter(Mandatory)][pscustomobject]$RuleBank,
+        [Parameter(Mandatory)][string]$Assay
+    )
+    $aKey = (($Assay + '').Trim())
+    if (-not $aKey) { $aKey = '(blank)' }
+
+    $c = $RuleBank.Compiled
+    if (-not $c) { return @($RuleBank.SampleExpectationRules) }
+
+    if ($c.ExpectRulesByAssay.ContainsKey($aKey)) { return @($c.ExpectRulesByAssay[$aKey]) }
+
+    $list = New-Object System.Collections.Generic.List[object]
+    foreach ($r in @($RuleBank.SampleExpectationRules)) {
+        if (-not $r) { continue }
+        if (-not (Test-RuleEnabled $r)) { continue }
+        $ruleAssay = (Get-RowField -Row $r -FieldName 'Assay')
+        if (-not (Test-AssayMatch -RuleAssay $ruleAssay -RowAssay $Assay)) { continue }
+        $list.Add($r)
+    }
+    $arr = $list.ToArray()
+    $c.ExpectRulesByAssay[$aKey] = $arr
+    return @($arr)
+}
+
+function Match-TextFast {
+    <#
+      Drop-in replacement for Match-Text with better performance:
+      - CONTAINS uses IndexOf(OrdinalIgnoreCase) to reduce allocations
+      - REGEX uses compiled regex cache if provided
+      Keeps behavior compatible with previous Match-Text implementation.
+    #>
+    param(
+        [Parameter(Mandatory)][string]$Text,
+        [Parameter(Mandatory)][string]$Pattern,
+        [Parameter(Mandatory)][string]$MatchType,
+        [Parameter(Mandatory=$false)][hashtable]$RegexCache
+    )
+
+    $t = ($Text + '')
+    $p = ($Pattern + '')
+    $m = ($MatchType + '').Trim().ToUpperInvariant()
+    if (-not $m) { $m = 'CONTAINS' }
+
+    try {
+        switch ($m) {
+            'REGEX'  {
+                if ($RegexCache -and $RegexCache.ContainsKey($p)) {
+                    return $RegexCache[$p].IsMatch($t)
+                }
+                return [regex]::IsMatch($t, $p, [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+            }
+            'EQUALS' {
+                return (($t.Trim()).ToUpperInvariant() -eq ($p.Trim()).ToUpperInvariant())
+            }
+            'PREFIX' {
+                $tt = ($t.Trim()).ToUpperInvariant()
+                $pp = ($p.Trim()).ToUpperInvariant()
+                if (-not $pp) { return $true }
+                return ($tt.Length -ge $pp.Length -and $tt.Substring(0, $pp.Length) -eq $pp)
+            }
+            'SUFFIX' {
+                $tt = ($t.Trim()).ToUpperInvariant()
+                $pp = ($p.Trim()).ToUpperInvariant()
+                if (-not $pp) { return $true }
+                return ($tt.Length -ge $pp.Length -and $tt.Substring($tt.Length - $pp.Length) -eq $pp)
+            }
+            default {
+                if (-not $p) { return $true }
+                return ($t.IndexOf($p, [System.StringComparison]::OrdinalIgnoreCase) -ge 0)
+            }
+        }
+    } catch {
+        return $false
+    }
+}
+
+function Get-TestTypePolicyForAssayCached {
+    <#
+      Memoized version of Get-TestTypePolicyForAssay.
+      Preserves original "first matching rule wins" semantics.
+    #>
+    param(
+        [Parameter(Mandatory)][pscustomobject]$RuleBank,
+        [Parameter(Mandatory)][string]$Assay
+    )
+    $aKey = (($Assay + '').Trim())
+    if (-not $aKey) { $aKey = '(blank)' }
+
+    $c = $RuleBank.Compiled
+    if (-not $c) { return (Get-TestTypePolicyForAssay -Assay $Assay -Policies $RuleBank.TestTypePolicy) }
+
+    if ($c.PolicyByAssay.ContainsKey($aKey)) { return $c.PolicyByAssay[$aKey] }
+
+    $pol = $null
+    foreach ($p in @($RuleBank.TestTypePolicy)) {
+        try {
+            if ((($p.Enabled + '')).Trim().Length -gt 0 -and ($p.Enabled + '').Trim().ToUpperInvariant() -in @('FALSE','0','NO','N')) { continue }
+            $pat = ($p.AssayPattern + '')
+            if (Test-AssayMatch -RuleAssay $pat -RowAssay $Assay) { $pol = $p; break }
+        } catch {}
+    }
+    $c.PolicyByAssay[$aKey] = $pol
+    return $pol
+}
+
+function Get-SampleNumberRuleForRowCached {
+    <#
+      Memoized wrapper for Get-SampleNumberRuleForRow semantics.
+      NOTE: BagNo participates in rule selection if BagNoPattern is used in the CSV,
+            therefore BagNo is part of the cache key.
+    #>
+    param(
+        [Parameter(Mandatory)][pscustomobject]$RuleBank,
+        [Parameter(Mandatory)][string]$Assay,
+        [Parameter(Mandatory)][string]$ControlCode,
+        [Parameter(Mandatory=$false)][string]$BagNo = ''
+    )
+
+    $aKey = (($Assay + '').Trim()); if (-not $aKey) { $aKey = '(blank)' }
+    $ccKey = (($ControlCode + '').Trim())
+    $bnKey = (($BagNo + '').Trim())
+    $key = $aKey + '|' + $ccKey + '|' + $bnKey
+
+    $c = $RuleBank.Compiled
+    if (-not $c) {
+        return (Get-SampleNumberRuleForRow -Assay $Assay -ControlCode $ControlCode -BagNo $BagNo -Rules $RuleBank.SampleNumberRules)
+    }
+
+    if ($c.SampleNumRuleByAssayCode.ContainsKey($key)) { return $c.SampleNumRuleByAssayCode[$key] }
+
+    $rule = Get-SampleNumberRuleForRow -Assay $Assay -ControlCode $ControlCode -BagNo $BagNo -Rules $RuleBank.SampleNumberRules
+    $c.SampleNumRuleByAssayCode[$key] = $rule
+    return $rule
+}
+
 
 function Get-RowField {
     param(
@@ -102,6 +325,34 @@
     }
     return ($ra -ieq $row)
 }
+
+function Get-TestTypePolicyForAssay {
+    <#
+      Returns the highest-priority enabled policy row matching the given assay.
+      Policy schema (RuleBank/08_TestTypePolicy.csv):
+        AssayPattern, AllowedTestTypes (pipe '|' or comma separated), Enabled, Priority, Note
+
+      Design goals:
+      - No assay hardcoding in engine.
+      - Specimen-only assays: AllowedTestTypes='Specimen' => strict (100% Specimen).
+      - Control assays: AllowedTestTypes may list control types; engine will always also allow 'Specimen'
+        unless the assay is specimen-only (to avoid false TESTTYPE_MISMATCH).
+    #>
+    param(
+        [Parameter(Mandatory)][string]$Assay,
+        [Parameter(Mandatory)][object[]]$Policies
+    )
+    if (-not $Policies) { return $null }
+    foreach ($p in $Policies) {
+        try {
+            if ((($p.Enabled + '')).Trim().Length -gt 0 -and ($p.Enabled + '').Trim().ToUpperInvariant() -in @('FALSE','0','NO','N')) { continue }
+            $pat = ($p.AssayPattern + '')
+            if (Test-AssayMatch -RuleAssay $pat -RowAssay $Assay) { return $p }
+        } catch {}
+    }
+    return $null
+}
+
 
 function Match-Text {
     param(
@@ -143,10 +394,10 @@
 function Get-ObservedCallDetailed {
     param(
         [Parameter(Mandatory)][object]$Row,
-        [Parameter(Mandatory)][object[]]$Patterns
-    )
-
-    $status = (Get-RowField -Row $Row -FieldName 'Status')
+        [Parameter(Mandatory)][object[]]$Patterns,
+        [Parameter(Mandatory=$false)][hashtable]$RegexCache
+    )
+$status = (Get-RowField -Row $Row -FieldName 'Status')
     $errTxt = (Get-RowField -Row $Row -FieldName 'Error')
     $testResult = (Get-RowField -Row $Row -FieldName 'Test Result')
     $assay = (Get-RowField -Row $Row -FieldName 'Assay')
@@ -177,6 +428,26 @@
         }
     }
 
+
+    # Precompute generic tokens for multi-target handling (non-MTB).
+    # NOTE: avoid DETECTED collision with NOT DETECTED by removing NOT DETECTED before checking DETECTED.
+    $hasErr = $false
+    $hasNeg = $false
+    $hasPos = $false
+    $isMixed = $false
+    if (-not ($ass -match '(?i)MTB')) {
+        $u = ($tr + '').ToUpperInvariant()
+        $u = [regex]::Replace($u, '\s+', ' ').Trim()
+
+        $hasErr = ($u -match '\bINVALID\b') -or ($u -match 'NO\s+RESULT') -or ($u -match '\bERROR\b')
+        $hasNeg = ($u -match 'NOT\s+DETECTED') -or ($u -match '\bNEGATIVE\b')
+
+        $uNoNotDetected = ($u -replace 'NOT\s+DETECTED', '')
+        $hasPos = ($uNoNotDetected -match '\bDETECTED\b') -or ($uNoNotDetected -match '\bPOSITIVE\b')
+
+        $isMixed = ($hasPos -and $hasNeg)
+    }
+
     foreach ($r in $Patterns) {
         if (-not (Test-RuleEnabled $r)) { continue }
         $ruleAssay = (Get-RowField -Row $r -FieldName 'Assay')
@@ -186,26 +457,56 @@
         if (-not ($pat + '').Trim()) { continue }
         $mt   = (Get-RowField -Row $r -FieldName 'MatchType')
 
-        if (Match-Text -Text $tr -Pattern $pat -MatchType $mt) {
+        if (Match-TextFast -Text $tr -Pattern $pat -MatchType $mt -RegexCache $RegexCache) {
             $call = ((Get-RowField -Row $r -FieldName 'Call') + '').Trim().ToUpperInvariant()
             if ($call) {
                 $note = (Get-RowField -Row $r -FieldName 'Note')
                 $why = if (($note + '').Trim()) { $note } else { ("Matched " + $mt + ": " + $pat) }
+                # If Test Result contains both POS and NEG tokens (multi-target), treat as MIXED for non-MTB.
+                if ($isMixed -and ($call -in @('POS','NEG'))) {
+                    return [pscustomobject]@{ Call='MIXED'; Reason=('Mixed POS+NEG tokens (pattern matched ' + $call + ')') }
+                }
                 return [pscustomobject]@{ Call=$call; Reason=$why }
             }
         }
     }
 
+    # --- Generic fallback for non-MTB assays (POS/NEG/ERROR tokens) ---
+    # This is used ONLY when no ResultCallPattern matched.
+    # Important: avoid "DETECTED" collision with "NOT DETECTED" by removing NOT DETECTED first.
+    if (-not ($ass -match '(?i)MTB')) {
+        $u = ($tr + '').ToUpperInvariant()
+        $u = [regex]::Replace($u, '\s+', ' ').Trim()
+
+        $hasErr = ($u -match '\bINVALID\b') -or ($u -match 'NO\s+RESULT') -or ($u -match '\bERROR\b')
+        $hasNeg = ($u -match 'NOT\s+DETECTED') -or ($u -match '\bNEGATIVE\b')
+
+        $uNoNotDetected = ($u -replace 'NOT\s+DETECTED', '')
+        $hasPos = ($uNoNotDetected -match '\bDETECTED\b') -or ($uNoNotDetected -match '\bPOSITIVE\b')
+
+        if ($hasErr) {
+            return [pscustomobject]@{ Call='ERROR'; Reason='Generic fallback: ERROR/INVALID/NO RESULT token' }
+        }
+        if ($hasPos) {
+            if ($hasNeg) {
+                return [pscustomobject]@{ Call='MIXED'; Reason='Generic fallback: Mixed POS+NEG tokens' }
+            }
+            return [pscustomobject]@{ Call='POS'; Reason='Generic fallback: DETECTED/POSITIVE token' }
+        }
+        if ($hasNeg) {
+            return [pscustomobject]@{ Call='NEG'; Reason='Generic fallback: NOT DETECTED/NEGATIVE token' }
+        }
+    }
+
     return [pscustomobject]@{ Call='UNKNOWN'; Reason='No pattern matched' }
 }
-
 function Get-ExpectedCallDetailed {
     param(
         [Parameter(Mandatory)][object]$Row,
-        [Parameter(Mandatory)][object[]]$Rules
-    )
-
-    $sampleId = (Get-RowField -Row $Row -FieldName 'Sample ID')
+        [Parameter(Mandatory)][object[]]$Rules,
+        [Parameter(Mandatory=$false)][hashtable]$RegexCache
+    )
+$sampleId = (Get-RowField -Row $Row -FieldName 'Sample ID')
     $assay    = (Get-RowField -Row $Row -FieldName 'Assay')
     $sid = ($sampleId + '').Trim()
     if (-not $sid) { return [pscustomobject]@{ Call=''; Reason='Blank Sample ID' } }
@@ -219,7 +520,7 @@
         $pat   = (Get-RowField -Row $r -FieldName 'SampleIdPattern')
         if (-not ($pat + '').Trim()) { continue }
 
-        if (Match-Text -Text $sid -Pattern $pat -MatchType $mtype) {
+        if (Match-TextFast -Text $sid -Pattern $pat -MatchType $mtype -RegexCache $RegexCache) {
             $call = ((Get-RowField -Row $r -FieldName 'Expected') + '').Trim().ToUpperInvariant()
             if ($call) {
                 $note = (Get-RowField -Row $r -FieldName 'Note')
@@ -337,7 +638,7 @@
     } catch {}
 
     $pressureFlag = $false
-    if ($pressure -ne $null -and $pressure -gt 90) { $pressureFlag = $true }
+    if ($pressure -ne $null -and $pressure -ge 90) { $pressureFlag = $true }
 
     # If pressure flag and there is a named blank describing it, surface the name
     if ($pressureFlag -and -not $name) {
@@ -373,6 +674,11 @@
     if ($o -eq 'ERROR') { return 'ERROR' }
     if ($o -eq 'UNKNOWN' -or -not $o) { return 'UNKNOWN' }
     if ($e -eq $o) { return 'OK' }
+    if ($o -eq 'MIXED') {
+    if ($e -eq 'POS') { return 'FN' }
+    if ($e -eq 'NEG') { return 'FP' }
+    return 'MISMATCH'
+    }
     if ($e -eq 'POS' -and $o -eq 'NEG') { return 'FN' }
     if ($e -eq 'NEG' -and $o -eq 'POS') { return 'FP' }
     return 'MISMATCH'
@@ -447,6 +753,24 @@
         [Parameter(Mandatory)][string]$MarkerType
     )
 
+
+    # Memoized marker lookup (one-shot performance)
+    $aKey = (($Assay + '').Trim())
+    if (-not $aKey) { $aKey = '(blank)' }
+    $tKey = (($MarkerType + '').Trim().ToUpperInvariant())
+    $mKey = ($aKey + '|' + $tKey)
+
+    try {
+        if ($RuleBank.Compiled -and $RuleBank.Compiled.MarkerByAssayType) {
+            $mc = $RuleBank.Compiled.MarkerByAssayType
+            if ($mc.ContainsKey($mKey)) {
+                $v = $mc[$mKey]
+                if ($v -eq '__MISS__') { return '' }
+                return ($v + '')
+            }
+        }
+    } catch {}
+
     foreach ($r in $RuleBank.SampleIdMarkers) {
         if (-not (Test-RuleEnabled $r)) { continue }
 
@@ -458,8 +782,10 @@
         if ($mt -ine $MarkerType) { continue }
 
         $m = ((Get-RowField -Row $r -FieldName 'Marker') + '').Trim()
+        try { if ($RuleBank.Compiled -and $RuleBank.Compiled.MarkerByAssayType) { $RuleBank.Compiled.MarkerByAssayType[$mKey] = $m } } catch {}
         return $m
     }
+    try { if ($RuleBank.Compiled -and $RuleBank.Compiled.MarkerByAssayType) { $RuleBank.Compiled.MarkerByAssayType[$mKey] = '__MISS__' } } catch {}
 
     return ''
 }
@@ -635,14 +961,119 @@
     return [pscustomobject]@{ SampleToken=$tok; BaseToken=$base; ActualSuffix=$act; SampleNum=$num; SampleNumRaw=$numRaw }
 }
 
+function Parse-SampleIdBasic {
+    <#
+      Basic, assay-agnostic Sample ID parsing.
+      Expected baseline format:
+        PREFIX_BagNo_SampleCode_RunToken
+      Where RunToken contains:
+        RunNo (01-20) + optional replacement marker (A/AA/AAA) + suffix (X or +)
+      Optional delamination segment may follow as additional token(s), e.g.:
+        ..._06+_D01,2A,2B,04
+      Notes:
+        - For controls: SampleCode 0 => expected PREFIX=NEG, SampleCode 1-5 => expected PREFIX=POS
+        - For specimen: PREFIX may be assay-specific; this function only parses.
+    #>
+    param(
+        [Parameter(Mandatory)][string]$SampleId,
+        [Parameter(Mandatory)][string]$DelamRegex,
+        [Parameter(Mandatory)][string]$XChar,
+        [Parameter(Mandatory)][string]$PlusChar
+    )
+
+    $out = [ordered]@{
+        Prefix = ''
+        BagNo = ''
+        SampleCode = ''
+        RunToken = ''
+        RunNoRaw = ''
+        RunNo = ''
+        RunSuffix = ''
+        ReplacementLevel = 0
+        DelamPresent = $false
+        DelamToken = ''
+        DelamCodes = @()
+    }
+
+    $sid = ($SampleId + '').Trim()
+    if (-not $sid) { return [pscustomobject]$out }
+
+    $parts = $sid.Split('_')
+    if ($parts.Count -ge 1) { $out.Prefix = (($parts[0] + '').Trim()).ToUpperInvariant() }
+    if ($parts.Count -ge 2) { $out.BagNo = (($parts[1] + '').Trim()) }
+    if ($parts.Count -ge 3) { $out.SampleCode = (($parts[2] + '').Trim()) }
+    if ($parts.Count -ge 4) { $out.RunToken = (($parts[3] + '').Trim()) }
+
+    # Detect delamination segment(s) AFTER run token
+    if ($parts.Count -ge 5) {
+        $dt = (($parts[4] + '').Trim())
+        if ($dt) {
+            $out.DelamToken = $dt
+            # Heuristic: token starting with "D" indicates delamination list ("D01,2A,04")
+            if ($dt -match '^(?i)D') { $out.DelamPresent = $true }
+        }
+    }
+
+    # Also detect embedded delam code anywhere in SampleId (covers "...06X-D01" etc.)
+    if (-not $out.DelamPresent -and $DelamRegex) {
+        try {
+            $rx = '(?i)(?:^|[_-])(' + $DelamRegex + ')(?:$|[,;_ -])'
+            if ([regex]::IsMatch($sid, $rx)) { $out.DelamPresent = $true }
+        } catch {}
+    }
+
+    # Parse run token: suffix is last char if X/+ (case-insensitive for X)
+    $rt = ($out.RunToken + '').Trim()
+    if ($rt.Length -ge 1) {
+        $last = $rt.Substring($rt.Length - 1, 1)
+        if ($last -eq $PlusChar -or $last.ToUpperInvariant() -eq $XChar.ToUpperInvariant()) {
+            $out.RunSuffix = $last.ToUpperInvariant()
+            $core = $rt.Substring(0, $rt.Length - 1)
+
+            # Replacement markers A/AA/AAA immediately before suffix
+            if ($core -match '(?i)(A{1,3})$') {
+                $a = $Matches[1]
+                $out.ReplacementLevel = $a.Length
+                $core = $core.Substring(0, $core.Length - $a.Length)
+            }
+
+            # Run number is leading digits (keep raw digits for pad validation)
+            if ($core -match '^(\d{1,4})') {
+                $out.RunNoRaw = $Matches[1]
+                $out.RunNo = $out.RunNoRaw
+            }
+        } else {
+            # No recognized suffix -> still try to extract run number
+            if ($rt -match '^(\d{1,4})') {
+                $out.RunNoRaw = $Matches[1]
+                $out.RunNo = $out.RunNoRaw
+            }
+        }
+    }
+
+    # Parse delamination codes list (if present)
+    if ($out.DelamToken) {
+        $codes = @()
+        foreach ($c in ($out.DelamToken -split ',')) {
+            $t = ($c + '').Trim()
+            if ($t) { $codes += $t }
+        }
+        $out.DelamCodes = $codes
+    }
+
+    return [pscustomobject]$out
+}
+
+
 function Get-SampleNumberRuleForRow {
     <#
-      07_SampleNumberRules.csv schema:
-        AssayPattern,SampleTypeCode,SampleNumberTokenIndex,SampleNumberRegex,SampleNumberMin,SampleNumberMax,SampleNumberPad,Enabled,Note,Priority
+      07_SampleNumberRules.csv schema (BagNoPattern is optional/backwards compatible):
+        AssayPattern,SampleTypeCode,BagNoPattern,SampleNumberTokenIndex,SampleNumberRegex,SampleNumberMin,SampleNumberMax,SampleNumberPad,Enabled,Note,Priority
     #>
     param(
         [Parameter(Mandatory)][string]$Assay,
         [Parameter(Mandatory)][string]$ControlCode,
+        [Parameter(Mandatory=$false)][string]$BagNo = '',
         [Parameter(Mandatory)][object[]]$Rules
     )
 
@@ -651,6 +1082,16 @@
 
         $ap = ((Get-RowField -Row $r -FieldName 'AssayPattern') + '').Trim()
         if (-not (Test-AssayMatch -RuleAssay $ap -RowAssay $Assay)) { continue }
+
+        # Optional bag gating (if BagNoPattern is present in CSV and non-empty)
+        $bp = ((Get-RowField -Row $r -FieldName 'BagNoPattern') + '').Trim()
+        if ($bp) {
+            $bn = ($BagNo + '').Trim()
+            if (-not $bn) { continue }
+            $bagOk = $false
+            try { $bagOk = [regex]::IsMatch($bn, $bp, [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) } catch { $bagOk = $false }
+            if (-not $bagOk) { continue }
+        }
 
         $cc = ((Get-RowField -Row $r -FieldName 'SampleTypeCode') + '').Trim()
         if (-not $cc -or $cc -eq '*') { return $r }
@@ -709,25 +1150,39 @@
         if (-not $group -or $group.Count -eq 0) { continue }
 
         $parCfg = Get-ParityConfigForAssay -RuleBank $RuleBank -Assay $assayKey
+
+        # Performance: pre-filter rule lists per assay once (preserves priority order)
+        $patternsForAssay = Get-ResultCallPatternsForAssay -RuleBank $RuleBank -Assay $assayKey
+        $expectForAssay   = Get-ExpectationRulesForAssay -RuleBank $RuleBank -Assay $assayKey
+        $regexCache = $null
+        try { if ($RuleBank.Compiled -and $RuleBank.Compiled.RegexCache) { $regexCache = $RuleBank.Compiled.RegexCache } } catch { $regexCache = $null }
         $delamPattern = $parCfg.DelamRegex
         $validSuffix = $parCfg.ValidSuffixRegex
 
         # Pre-scan for parity + majority suffix
         $numeric = New-Object System.Collections.Generic.List[long]
+        $parityPairs = New-Object System.Collections.Generic.List[object]
         $suffixCounts = @{}
         $suffixCounts[$parCfg.XChar.ToUpperInvariant()] = 0
         $suffixCounts[$parCfg.PlusChar] = 0
 
         foreach ($row in $group) {
             $sn = (Get-RowField -Row $row -FieldName $parCfg.CartridgeField)
+            $snN = $null
             if (($sn + '').Trim() -match '^\d+$') {
+                try { $snN = [long]($sn + '') } catch {}
                 try { $numeric.Add([long]($sn + '')) } catch {}
             }
 
             $sid = (Get-RowField -Row $row -FieldName 'Sample ID')
             if (($sid + '').Trim()) {
                 $t = Get-SampleTokenAndBase -SampleId ($sid + '') -TokenIndex $parCfg.TokenIndex -DelamPattern $delamPattern -ValidSuffixRegex $validSuffix -XChar $parCfg.XChar -PlusChar $parCfg.PlusChar
-                if ($t.ActualSuffix -and $suffixCounts.ContainsKey($t.ActualSuffix)) { $suffixCounts[$t.ActualSuffix]++ }
+                if ($t.ActualSuffix -and $suffixCounts.ContainsKey($t.ActualSuffix)) {
+                    $suffixCounts[$t.ActualSuffix]++
+                    if ($snN -ne $null) {
+                        try { $parityPairs.Add([pscustomobject]@{ SN=$snN; Sfx=$t.ActualSuffix }) } catch {}
+                    }
+                }
             }
         }
 
@@ -739,26 +1194,54 @@
         $minSn = $null
         $parityForX = $null
         if ($useParity) {
-            try {
-                $minSn = ($numeric | Measure-Object -Minimum).Minimum
-                $parityForX = [int]($minSn % 2)
-            } catch {
-                $useParity = $false
-            }
+            try { $minSn = ($numeric | Measure-Object -Minimum).Minimum } catch { $minSn = $null }
+
+            # Choose parity mapping ONLY when the data is perfectly consistent (simple majority math).
+            # If we cannot reach 100% agreement for either mapping, we do NOT enforce suffix parity.
+            if ($parityPairs) {
+                $m0 = 0; $m1 = 0; $tot = 0
+                foreach ($pp in $parityPairs) {
+                    $sn = $null
+                    try { $sn = [long]$pp.SN } catch { $sn = $null }
+                    if ($sn -eq $null) { continue }
+                    $sfx = (($pp.Sfx + '')).Trim()
+                    if (-not $sfx) { continue }
+                    $par = [int]($sn % 2)
+
+                    $exp0 = if ($par -eq 0) { $parCfg.XChar.ToUpperInvariant() } else { $parCfg.PlusChar }
+                    $exp1 = if ($par -eq 1) { $parCfg.XChar.ToUpperInvariant() } else { $parCfg.PlusChar }
+
+                    $tot++
+                    if ($sfx -eq $exp0) { $m0++ }
+                    if ($sfx -eq $exp1) { $m1++ }
+                }
+
+                if ($tot -gt 0) {
+                    if ($m0 -eq $tot) { $parityForX = 0 }
+                    elseif ($m1 -eq $tot) { $parityForX = 1 }
+                }
+            }
+if ($parityForX -eq $null) { $useParity = $false }
         }
 
         $majSuffix = ''
         if (-not $useParity) {
             $xCount = $suffixCounts[$parCfg.XChar.ToUpperInvariant()]
             $pCount = $suffixCounts[$parCfg.PlusChar]
-            if ($xCount -gt $pCount) { $majSuffix = $parCfg.XChar.ToUpperInvariant() }
-            elseif ($pCount -gt $xCount) { $majSuffix = $parCfg.PlusChar }
+            $totS = 0
+            try { $totS = [int]$xCount + [int]$pCount } catch { $totS = 0 }
+
+            # Only use majority suffix when ALL observed suffixes are the same.
+            if ($totS -gt 0) {
+                if ($xCount -eq $totS) { $majSuffix = $parCfg.XChar.ToUpperInvariant() }
+                elseif ($pCount -eq $totS) { $majSuffix = $parCfg.PlusChar }
+            }
         }
 
         foreach ($row in $group) {
             try {
-                $obsD = Get-ObservedCallDetailed -Row $row -Patterns $RuleBank.ResultCallPatterns
-                $expD = Get-ExpectedCallDetailed -Row $row -Rules $RuleBank.SampleExpectationRules
+                $obsD = Get-ObservedCallDetailed -Row $row -Patterns $patternsForAssay -RegexCache $regexCache
+                $expD = Get-ExpectedCallDetailed -Row $row -Rules $expectForAssay -RegexCache $regexCache
 
                 $sid = (Get-RowField -Row $row -FieldName 'Sample ID')
                 $assay = (Get-RowField -Row $row -FieldName 'Assay')
@@ -790,6 +1273,13 @@
                 $tokInfo = [pscustomobject]@{ SampleToken=''; BaseToken=''; ActualSuffix=''; SampleNum=''; SampleNumRaw='' }
                 if (($sid + '').Trim()) {
                     $tokInfo = Get-SampleTokenAndBase -SampleId ($sid + '') -TokenIndex $parCfg.TokenIndex -DelamPattern $delamPattern -ValidSuffixRegex $validSuffix -XChar $parCfg.XChar -PlusChar $parCfg.PlusChar
+
+                # Basic SampleId parsing (PREFIX/BAG/CODE/RUN + delam/replacement)
+                $sidBasic = [pscustomobject]@{ Prefix=''; BagNo=''; SampleCode=''; RunToken=''; RunNoRaw=''; RunNo=''; RunSuffix=''; ReplacementLevel=0; DelamPresent=$false; DelamToken=''; DelamCodes=@() }
+                if (($sid + '').Trim()) {
+                    $sidBasic = Parse-SampleIdBasic -SampleId ($sid + '') -DelamRegex $delamPattern -XChar $parCfg.XChar -PlusChar $parCfg.PlusChar
+                }
+
                 }
 
                 $expectedSuffix = ''
@@ -824,7 +1314,7 @@
                 $cc = Get-ControlCodeFromRow -Row $row -SampleTypeCodeTokenIndex $parCfg.SampleTypeCodeTokenIndex
 
                 $rule = $null
-                try { $rule = Get-SampleNumberRuleForRow -Assay $assay -ControlCode $cc -Rules $RuleBank.SampleNumberRules } catch {}
+                try { $rule = Get-SampleNumberRuleForRowCached -RuleBank $RuleBank -Assay $assay -ControlCode $cc -BagNo $sidBasic.BagNo } catch {}
 
                 $snTokIndex = $parCfg.SampleNumberTokenIndex
                 if ($rule) {
@@ -876,6 +1366,15 @@
 
                 $results.Add([pscustomobject]@{
                     SampleId         = $sid
+                    SamplePrefix     = $sidBasic.Prefix
+                    BagNo            = $sidBasic.BagNo
+                    SampleCode       = $sidBasic.SampleCode
+                    RunNo            = $sidBasic.RunNo
+                    RunNoRaw         = $sidBasic.RunNoRaw
+                    RunSuffix        = $sidBasic.RunSuffix
+                    ReplacementLevel = $sidBasic.ReplacementLevel
+                    DelamPresent     = $sidBasic.DelamPresent
+                    DelamCodes       = ($sidBasic.DelamCodes -join ',')
                     CartridgeSN      = (Get-RowField -Row $row -FieldName $parCfg.CartridgeField)
                     Assay            = $assay
                     AssayVersion     = (Get-RowField -Row $row -FieldName 'Assay Version')
@@ -936,6 +1435,27 @@
     $distinctAssayVersions = @($results | ForEach-Object { ($_.AssayVersion + '').Trim() } | Where-Object { $_ } | Sort-Object -Unique)
     $distinctReagentLots = @($results | ForEach-Object { ($_.ReagentLotId + '').Trim() } | Where-Object { $_ } | Sort-Object -Unique)
 
+
+    # Outlier assay/version tagging (reduce noise; keep signal about mixed inputs)
+    $majorAssay = ''
+    if ($distinctAssays.Count -gt 1) {
+        try { $majorAssay = ($results | Group-Object Assay | Sort-Object Count -Descending | Select-Object -First 1).Name } catch {}
+        foreach ($r in $results) {
+            $a = ((($r.Assay + '')).Trim())
+            if ($majorAssay -and $a -and $a -ne $majorAssay) { _Append-RuleFlag -row $r -flag 'DQ_ASSAY_OUTLIER' }
+        }
+    }
+
+    $majorVer = ''
+    if ($distinctAssayVersions.Count -gt 1) {
+        try { $majorVer = ($results | Group-Object AssayVersion | Sort-Object Count -Descending | Select-Object -First 1).Name } catch {}
+        foreach ($r in $results) {
+            $v = ((($r.AssayVersion + '')).Trim())
+            if ($majorVer -and $v -and $v -ne $majorVer) { _Append-RuleFlag -row $r -flag 'DQ_ASSAYVER_OUTLIER' }
+        }
+    }
+
+
     # Duplicate Sample IDs
     $dupSample = @($results | Where-Object { (($_.SampleId + '').Trim()) } | Group-Object SampleId | Where-Object { $_.Count -gt 1 })
     if ($dupSample.Count -gt 0) {
@@ -959,12 +1479,141 @@
     }
 
     # Test Type mismatch (derived expected vs actual)
+    # Data-driven: only enforce if the file mostly follows the SampleCode->TestType convention.
+    $useStrictTestType = $false
+    try {
+        $ttAll = @($results | Where-Object { (($_.ExpectedTestType + '')).Trim() -and (($_.TestType + '')).Trim() })
+        $ttCtl = @($ttAll | Where-Object { (($_.ExpectedTestType + '')).Trim().ToUpperInvariant() -ne 'SPECIMEN' })
+        if ($ttCtl.Count -ge 5) {
+            $ttMatch = @($ttCtl | Where-Object { (($_.TestType + '')).Trim().ToUpperInvariant() -eq (($_.ExpectedTestType + '')).Trim().ToUpperInvariant() }).Count
+            $ttRate = 0.0
+            try { $ttRate = [double]$ttMatch / [double]$ttCtl.Count } catch { $ttRate = 0.0 }
+            if ($ttRate -ge 0.80) { $useStrictTestType = $true }
+        }
+    } catch { $useStrictTestType = $false }
+
+    if ($useStrictTestType) {
+        foreach ($r in $results) {
+            # Skip assay/version outliers to avoid cascading false flags.
+            $rf = ((($r.RuleFlags + '')).Trim())
+            if ($rf) {
+                $p = $rf.Split('|')
+                if ($p -contains 'DQ_ASSAY_OUTLIER' -or $p -contains 'DQ_ASSAYVER_OUTLIER') { continue }
+            }
+
+            $act = ((($r.TestType + '')).Trim())
+            $ass = ((($r.Assay + '')).Trim())
+
+            # Prefer policy-driven validation (RuleBank/08_TestTypePolicy.csv) when available.
+            $pol = $null
+            try { $pol = Get-TestTypePolicyForAssayCached -RuleBank $RuleBank -Assay $ass } catch { $pol = $null }
+
+            if ($pol) {
+                $allowed = @()
+                $raw = (($pol.AllowedTestTypes + '')).Trim()
+                if ($raw) {
+                    # support either pipe- or comma-separated lists
+                    if ($raw -like '*|*') { $allowed = @($raw.Split('|') | ForEach-Object { ($_ + '').Trim() } | Where-Object { $_ }) }
+                    else { $allowed = @($raw.Split(',') | ForEach-Object { ($_ + '').Trim() } | Where-Object { $_ }) }
+                }
+
+                # If the policy lists any Control types, we also allow 'Specimen' by default.
+                # (This prevents false TESTTYPE_MISMATCH when a run contains both controls and specimens.)
+                if ($allowed -and ($allowed | Where-Object { $_ -match 'Control' }).Count -gt 0) {
+                    if (-not ($allowed | Where-Object { $_ -ieq 'Specimen' })) { $allowed += 'Specimen' }
+                }
+
+                if (-not $allowed -or -not $act) {
+                    _Append-RuleFlag -row $r -flag 'TESTTYPE_MISMATCH'
+                } else {
+                    $ok = $false
+                    foreach ($t in $allowed) {
+                        if ($act.ToUpperInvariant() -eq ($t + '').Trim().ToUpperInvariant()) { $ok = $true; break }
+                    }
+                    if (-not $ok) { _Append-RuleFlag -row $r -flag 'TESTTYPE_MISMATCH' }
+                }
+            } else {
+                # Legacy behavior: compare against ExpectedTestType when available.
+                $exp = ((($r.ExpectedTestType + '')).Trim())
+                if ($act -and $exp -and ($act.ToUpperInvariant() -ne $exp.ToUpperInvariant())) {
+                    _Append-RuleFlag -row $r -flag 'TESTTYPE_MISMATCH'
+                }
+            }
+        }  }
+
+    # Suffix/sample number quick flags (so exception-only debug includes these)
     foreach ($r in $results) {
-        $act = ((($r.TestType + '')).Trim())
-        $exp = ((($r.ExpectedTestType + '')).Trim())
-        if ($act -and $exp -and ($act.ToUpperInvariant() -ne $exp.ToUpperInvariant())) {
-            _Append-RuleFlag -row $r -flag 'TESTTYPE_MISMATCH'
-        }
+        $rf = ((($r.RuleFlags + '')).Trim())
+        $isOutlier = $false
+        if ($rf) {
+            $p = $rf.Split('|')
+            if ($p -contains 'DQ_ASSAY_OUTLIER' -or $p -contains 'DQ_ASSAYVER_OUTLIER') { $isOutlier = $true }
+        }
+        if ($isOutlier) { continue }
+        $sc = ((($r.SuffixCheck + '')).Trim().ToUpperInvariant())
+        if ($sc -and $sc -ne 'OK') { _Append-RuleFlag -row $r -flag ('SUFFIX_' + $sc) }
+        $snok = ((($r.SampleNumOK + '')).Trim().ToUpperInvariant())
+        if ($snok -eq 'NO') { _Append-RuleFlag -row $r -flag 'SAMPLENUM_BAD' }
+    }
+
+
+    # Data-driven PREFIX validation: only enforce NEG/POS convention if it holds for this file.
+    $useStrictPrefix = $false
+    try {
+        $p0 = @($results | Where-Object { (($_.SampleCode + '')).Trim() -eq '0' -and (($_.SamplePrefix + '')).Trim() })
+        $pP = @($results | Where-Object { (($_.SampleCode + '')).Trim() -match '^[1-5]$' -and (($_.SamplePrefix + '')).Trim() })
+
+        $ok0 = @($p0 | Where-Object { (($_.SamplePrefix + '')).Trim().ToUpperInvariant() -eq 'NEG' }).Count
+        $okP = @($pP | Where-Object { (($_.SamplePrefix + '')).Trim().ToUpperInvariant() -eq 'POS' }).Count
+
+        $r0 = 0.0; $rP = 0.0
+        if ($p0.Count -gt 0) { try { $r0 = [double]$ok0 / [double]$p0.Count } catch { $r0 = 0.0 } }
+        if ($pP.Count -gt 0) { try { $rP = [double]$okP / [double]$pP.Count } catch { $rP = 0.0 } }
+
+        if ($p0.Count -ge 3 -and $pP.Count -ge 3 -and $r0 -ge 0.80 -and $rP -ge 0.80) {
+            $useStrictPrefix = $true
+        } elseif ($p0.Count -ge 10 -and $pP.Count -eq 0 -and $r0 -ge 0.90) {
+            $useStrictPrefix = $true
+        } elseif ($pP.Count -ge 10 -and $p0.Count -eq 0 -and $rP -ge 0.90) {
+            $useStrictPrefix = $true
+        }
+    } catch { $useStrictPrefix = $false }
+
+    # Basic SampleId validations (assay-agnostic, catches gaps when no specific rules exist)
+    foreach ($r in $results) {
+        # Skip assay/version outliers to avoid cascading false flags.
+        $rf = ((($r.RuleFlags + '')).Trim())
+        if ($rf) {
+            $p = $rf.Split('|')
+            if ($p -contains 'DQ_ASSAY_OUTLIER' -or $p -contains 'DQ_ASSAYVER_OUTLIER') { continue }
+        }
+
+        $sidp = ((($r.SamplePrefix + '')).Trim().ToUpperInvariant())
+        $scode = ((($r.SampleCode + '')).Trim())
+        if ($useStrictPrefix -and $scode -match '^\d+$') {
+            $si = 0; try { $si = [int]$scode } catch { $si = 0 }
+            if ($si -eq 0) {
+                if ($sidp -and $sidp -ne 'NEG') { _Append-RuleFlag -row $r -flag 'PREFIX_BAD' }
+            } elseif ($si -ge 1 -and $si -le 5) {
+                if ($sidp -and $sidp -ne 'POS') { _Append-RuleFlag -row $r -flag 'PREFIX_BAD' }
+            }
+        }
+
+        $rnRaw = ((($r.RunNoRaw + '')).Trim())
+        $rn = ((($r.RunNo + '')).Trim())
+        if ($rnRaw) {
+            if ($rnRaw.Length -ne 2) { _Append-RuleFlag -row $r -flag 'RUNNO_BAD' }
+            $ni = 0; try { $ni = [int]$rn } catch { $ni = 0 }
+            if ($ni -lt 1 -or $ni -gt 20) { _Append-RuleFlag -row $r -flag 'RUNNO_BAD' }
+        }
+
+        $dl = $false
+        try { $dl = [bool]$r.DelamPresent } catch { $dl = $false }
+        if ($dl) { _Append-RuleFlag -row $r -flag 'DELAM_PRESENT' }
+
+        $rl = 0
+        try { $rl = [int]$r.ReplacementLevel } catch { $rl = 0 }
+        if ($rl -ge 1) { _Append-RuleFlag -row $r -flag ('REPL_A' + $rl) }
     }
 
     # Module hotspot: >=3 ERROR rows on same Module S/N
@@ -988,6 +1637,10 @@
         DuplicateSampleIdCount = ($dupSample | ForEach-Object { $_.Name } | Select-Object -Unique).Count
         DuplicateCartridgeSnCount = ($dupCart | ForEach-Object { $_.Name } | Select-Object -Unique).Count
         HotModuleCount = $hotModules.Count
+        DelamCount = @($results | Where-Object { try { [bool]$_.DelamPresent } catch { $false } }).Count
+        ReplacementCount = @($results | Where-Object { try { [int]$_.ReplacementLevel -ge 1 } catch { $false } }).Count
+        BadPrefixCount = @($results | Where-Object { (($_.RuleFlags + '') -split '\|') -contains 'PREFIX_BAD' }).Count
+        BadRunNoCount  = @($results | Where-Object { (($_.RuleFlags + '') -split '\|') -contains 'RUNNO_BAD' }).Count
     }
     # ---------------------------------------------------------------
     $summary = [pscustomobject]@{
@@ -995,6 +1648,10 @@
         ObservedCounts = @{}
         DeviationCounts = @{}
         RetestYes = 0
+        MinorFunctionalError = 0
+        InstrumentError = 0
+        DelamCount = 0
+        ReplacementCount = 0
     }
 
     foreach ($r in $results) {
@@ -1006,9 +1663,81 @@
 
         $rt = ($r.GeneratesRetest + '').Trim().ToUpperInvariant()
         if ($rt -in @('YES','Y','TRUE','1')) { $summary.RetestYes++ }
-    }
-
-    $top = @($results | Where-Object { $_.Deviation -in @('FP','FN','ERROR','MISMATCH') } | Select-Object -First 50)
+        # Extra QC counts used by summary:
+        $dl = $false
+        try { $dl = [bool]$r.DelamPresent } catch { $dl = $false }
+        if ($dl) { $summary.DelamCount++ }
+
+        $rl = 0
+        try { $rl = [int]$r.ReplacementLevel } catch { $rl = 0 }
+        if ($rl -ge 1) { $summary.ReplacementCount++ }
+
+        # Split Deviation=ERROR into Minor Functional vs Instrument Error
+        if ((($r.Deviation + '')).Trim().ToUpperInvariant() -eq 'ERROR') {
+            $code = ((($r.ErrorCode + '')).Trim())
+            $known = $false
+            if ($code -match '^\d{4,5}$') { try { $known = $errLut.Codes.ContainsKey($code) } catch { $known = $false } }
+
+            $isMtbInd = $false
+            try {
+                if ((($r.Assay + '') -match '(?i)MTB') -and ((($r.TestResult + '') -match '(?i)INDETERMINATE'))) { $isMtbInd = $true }
+            } catch {}
+
+            if ($known -or $isMtbInd) { $summary.MinorFunctionalError++ }
+            else { $summary.InstrumentError++ }
+        }
+
+    }
+
+    
+    # --- Coverage diagnostics (deterministic) ---
+    # NOTE: Adds only summary metadata; does not change per-row classification/flags.
+    $assayList = @($results | ForEach-Object { ($_.Assay + '').Trim() } | Where-Object { $_ } | Select-Object -Unique)
+    $ttMatched = 0
+    $ttMissing = @()
+    $ttDetails = @()
+    foreach ($a in $assayList) {
+        $pol = $null
+        try { $pol = Get-TestTypePolicyForAssayCached -RuleBank $RuleBank -Assay $a } catch { $pol = $null }
+        if ($pol) {
+            $ttMatched++
+            $pat = ((Get-RowField -Row $pol -FieldName 'AssayPattern') + '').Trim()
+            $allowed = ((Get-RowField -Row $pol -FieldName 'AllowedTestTypes') + '').Trim()
+            if (-not $allowed) { $allowed = ((Get-RowField -Row $pol -FieldName 'TestTypes') + '').Trim() }
+            $ttDetails += ($a + ' => ' + $allowed + ' (pattern=' + $pat + ')')
+        } else {
+            $ttMissing += $a
+        }
+    }
+
+    # SampleID parse coverage (based on parsed fields)
+    $sidTotal = @($results | Where-Object { (($_.SampleId + '')).Trim().Length -gt 0 }).Count
+    $sidOk = @($results | Where-Object {
+        (($_.SampleId + '')).Trim().Length -gt 0 -and
+        (($_.BagNo + '')).Trim().Length -gt 0 -and
+        (($_.SampleCode + '')).Trim().Length -gt 0 -and
+        (($_.RunNo + '')).Trim().Length -gt 0 -and
+        (($_.RunSuffix + '')).Trim().Length -gt 0
+    }).Count
+
+    # 07 SampleNumberRules coverage (SampleNumOK populated only when a rule matched)
+    $snTotal = $sidTotal
+    $snCovered = @($results | Where-Object {
+        (($_.SampleId + '')).Trim().Length -gt 0 -and
+        (($_.SampleNumOK + '')).Trim().Length -gt 0
+    }).Count
+
+    $summary | Add-Member -NotePropertyName 'TestTypePolicyAssaysTotal' -NotePropertyValue $assayList.Count -Force
+    $summary | Add-Member -NotePropertyName 'TestTypePolicyAssaysMatched' -NotePropertyValue $ttMatched -Force
+    $summary | Add-Member -NotePropertyName 'TestTypePolicyAssaysMissing' -NotePropertyValue ($ttMissing -join ', ') -Force
+    $summary | Add-Member -NotePropertyName 'TestTypePolicyDetails' -NotePropertyValue $ttDetails -Force
+
+    $summary | Add-Member -NotePropertyName 'SampleIdParseTotal' -NotePropertyValue $sidTotal -Force
+    $summary | Add-Member -NotePropertyName 'SampleIdParseOk' -NotePropertyValue $sidOk -Force
+    $summary | Add-Member -NotePropertyName 'SampleNumberRuleTotal' -NotePropertyValue $snTotal -Force
+    $summary | Add-Member -NotePropertyName 'SampleNumberRuleCovered' -NotePropertyValue $snCovered -Force
+    # -------------------------------------------
+$top = @($results | Where-Object { $_.Deviation -in @('FP','FN','ERROR','MISMATCH') } | Select-Object -First 50)
 
     return [pscustomobject]@{ Rows = $results.ToArray(); Summary = $summary; TopDeviations = $top; QC = $qc }
 }
@@ -1027,72 +1756,148 @@
 
     $ws = $Pkg.Workbook.Worksheets.Add('RuleEngine_Debug')
 
+    # Column layout inspired by RuleEngine_Debug_FUTURE.xlsx (Swedish, fewer columns, more QC-friendly)
     $headers = @(
-        '#','Sample ID','Cartridge S/N','Module S/N','Start Time',
-        'Test Type','Expected Test Type','ControlCode',
-        'SampleToken','BaseToken','ActualSuffix','ExpectedSuffix','SuffixCheck','SuffixSource',
-        'SampleNum','SampleNumOK','SampleNumWhy',
-        'Expected Call','ExpectedSource','Observed Call','ObservedWhy','Deviation','RuleFlags',
-        'Status','ErrorCode','ErrorName','Retest','Max Pressure','PressureFlag',
-        'Test Result','Error'
-    )
-
-    # --- Summary section (always written, even when exception-only table has 0 rows) ---
+        'Prov-ID',
+        'Felkod',
+        'Avvikelse',
+        'Flaggor',
+        'Förväntat suffix',
+        'Suffixkontroll',
+        'Kassett S/N',
+        'Modul S/N',
+        'Starttid',
+        'Testtyp',
+        'Förväntad testtyp',
+        'Observerat (varför)',
+        'Status',
+        'Felnamn',
+        'Omkörning',
+        'Maxtryck (PSI)',
+        'Testresultat',
+        'Feltext'
+    )
+
+    # -------------------- Summary (always) --------------------
     $row = 1
-    $ws.Cells[$row,1].Value = 'RuleEngine Debug Summary'
-    $ws.Cells[$row,1].Style.Font.Bold = $true
+    $ws.Cells.Item($row,1).Value = 'Sammanfattning felsökning'
+    $ws.Cells.Item($row,1).Style.Font.Bold = $true
     $row++
 
     $sum = $RuleEngineResult.Summary
     $qc  = $RuleEngineResult.QC
-
-    function _WriteKV {
-        param([int]$r, [string]$k, $v)
-        $ws.Cells[$r,1].Value = $k
-        $ws.Cells[$r,2].Value = $v
-        $ws.Cells[$r,1].Style.Font.Bold = $true
-    }
-
-    _WriteKV -r $row -k 'Total tests' -v $sum.Total; $row++
-
-    foreach ($k in @('OK','FP','FN','ERROR','MISMATCH','UNKNOWN')) {
-        if ($sum.DeviationCounts.ContainsKey($k)) { _WriteKV -r $row -k ('Deviation ' + $k) -v $sum.DeviationCounts[$k]; $row++ }
-    }
+    $allRows = @($RuleEngineResult.Rows)
+
+     function _KV {
+         param([int]$r, [string]$k, $v, [int]$c = 1)
+     $ws.Cells.Item($r,$c).Value = $k
+     $ws.Cells.Item($r,$c+1).Value = $v
+     $ws.Cells.Item($r,$c).Style.Font.Bold = $true
+     }
+
+    $assayTxt = ''
+    if ($qc -and $qc.DistinctAssays -and $qc.DistinctAssays.Count -eq 1) { $assayTxt = $qc.DistinctAssays[0] }
+    elseif ($qc -and $qc.DistinctAssays -and $qc.DistinctAssays.Count -gt 1) { $assayTxt = 'Flera (' + ($qc.DistinctAssays.Count) + ')' }
+
+    $verTxt = ''
+    if ($qc -and $qc.DistinctAssayVersions -and $qc.DistinctAssayVersions.Count -eq 1) { $verTxt = $qc.DistinctAssayVersions[0] }
+    elseif ($qc -and $qc.DistinctAssayVersions -and $qc.DistinctAssayVersions.Count -gt 1) { $verTxt = 'Flera (' + ($qc.DistinctAssayVersions.Count) + ')' }
+
+    $lotTxt = ''
+    if ($qc -and $qc.DistinctReagentLots -and $qc.DistinctReagentLots.Count -eq 1) { $lotTxt = $qc.DistinctReagentLots[0] }
+    elseif ($qc -and $qc.DistinctReagentLots -and $qc.DistinctReagentLots.Count -gt 1) { $lotTxt = 'Flera (' + ($qc.DistinctReagentLots.Count) + ')' }
+
+    # Row 2: multiple key/value pairs on one line
+    _KV -r $row -k 'Totalt tester' -v $sum.Total -c 1
+    _KV -r $row -k 'Assay' -v $assayTxt -c 3
+    _KV -r $row -k 'Assay Version' -v $verTxt -c 5
+    _KV -r $row -k 'Reagent Lot' -v $lotTxt -c 7
+    $row++
+
+    $ok = 0; if ($sum.DeviationCounts.ContainsKey('OK')) { $ok = $sum.DeviationCounts['OK'] }
+    _KV -r $row -k 'Tester GK' -v $ok; $row++
+
+    foreach ($k in @('FP','FN','ERROR','MISMATCH','UNKNOWN')) {
+        if ($sum.DeviationCounts.ContainsKey($k)) {
+            $label = switch ($k) {
+                'FP' { 'FP' }
+                'FN' { 'FN' }
+                'ERROR' { 'Deviation ERROR (totalt)' }
+                'MISMATCH' { 'Mismatch' }
+                'UNKNOWN' { 'Okänt (UNKNOWN)' }
+                default { $k }
+            }
+            _KV -r $row -k $label -v $sum.DeviationCounts[$k]; $row++
+        }
+    }
+
+
+    # Split ERROR into categories (from RuleBank ErrorCodes + MTB Indeterminate)
+    if ($sum -and ($sum.MinorFunctionalError -ne $null -or $sum.InstrumentError -ne $null)) {
+        _KV -r $row -k 'Minor Functional Error' -v $sum.MinorFunctionalError; $row++
+        _KV -r $row -k 'Instrument Error' -v $sum.InstrumentError; $row++
+    }
+
+    # Extra summary signals
+    if ($sum -and $sum.DelamCount -ne $null) { _KV -r $row -k 'Delamineringar (Sample ID)' -v $sum.DelamCount; $row++ }
+    if ($sum -and $sum.ReplacementCount -ne $null) { _KV -r $row -k 'Ersättningar (A/AA/AAA)' -v $sum.ReplacementCount; $row++ }
 
     foreach ($k in @('POS','NEG','ERROR','UNKNOWN')) {
-        if ($sum.ObservedCounts.ContainsKey($k)) { _WriteKV -r $row -k ('Observed ' + $k) -v $sum.ObservedCounts[$k]; $row++ }
-    }
-
-    _WriteKV -r $row -k 'Retest YES' -v $sum.RetestYes; $row++
+        if ($sum.ObservedCounts.ContainsKey($k)) {
+            _KV -r $row -k ('Observerat ' + $k) -v $sum.ObservedCounts[$k]; $row++
+        }
+    }
+
+    _KV -r $row -k 'Omkörning (YES)' -v $sum.RetestYes; $row++
 
     if ($qc) {
-        _WriteKV -r $row -k 'Assays (distinct)' -v ($qc.DistinctAssays.Count); $row++
-        _WriteKV -r $row -k 'Assay versions (distinct)' -v ($qc.DistinctAssayVersions.Count); $row++
-        _WriteKV -r $row -k 'Reagent lots (distinct)' -v ($qc.DistinctReagentLots.Count); $row++
-        _WriteKV -r $row -k 'Duplicate Sample IDs' -v $qc.DuplicateSampleIdCount; $row++
-        _WriteKV -r $row -k 'Duplicate Cartridge S/N' -v $qc.DuplicateCartridgeSnCount; $row++
-        _WriteKV -r $row -k 'Hot modules (>=3 errors)' -v $qc.HotModuleCount; $row++
-
-        if ($qc.DistinctAssays.Count -gt 1) { _WriteKV -r $row -k 'Assay list' -v ($qc.DistinctAssays -join ', '); $row++ }
-        if ($qc.DistinctAssayVersions.Count -gt 1) { _WriteKV -r $row -k 'Assay version list' -v ($qc.DistinctAssayVersions -join ', '); $row++ }
-        if ($qc.DistinctReagentLots.Count -gt 1) { _WriteKV -r $row -k 'Reagent lot list' -v ($qc.DistinctReagentLots -join ', '); $row++ }
-    }
-
+        _KV -r $row -k 'Dubbletter av Sample ID' -v $qc.DuplicateSampleIdCount; $row++
+        _KV -r $row -k 'Dubbletter av Cartridge S/N' -v $qc.DuplicateCartridgeSnCount; $row++
+        _KV -r $row -k 'Moduler med error (≥3 fel)' -v $qc.HotModuleCount; $row++
+        # --- Coverage diagnostics (RuleBank coverage) ---
+        if ($sum -and $sum.PSObject -and ($sum.PSObject.Properties.Name -contains 'TestTypePolicyAssaysTotal')) {
+            _KV -r $row -k '08 TestTypePolicy (assays matchade)' -v (("$($sum.TestTypePolicyAssaysMatched)/$($sum.TestTypePolicyAssaysTotal)")); $row++
+            if (($sum.TestTypePolicyAssaysMissing + '').Trim()) { _KV -r $row -k '08 saknar policy för assay' -v $sum.TestTypePolicyAssaysMissing; $row++ }
+
+            # If there are only a few assays, show the resolved policy rows for transparency
+            try {
+                $det = @($sum.TestTypePolicyDetails)
+                if ($det -and $det.Count -gt 0 -and $det.Count -le 6) {
+                    foreach ($d in $det) { _KV -r $row -k '08 policy' -v $d; $row++ }
+                }
+            } catch {}
+        }
+
+        if ($sum -and $sum.PSObject -and ($sum.PSObject.Properties.Name -contains 'SampleIdParseTotal')) {
+            _KV -r $row -k 'Sample ID parse OK' -v (("$($sum.SampleIdParseOk)/$($sum.SampleIdParseTotal)")); $row++
+        }
+        if ($sum -and $sum.PSObject -and ($sum.PSObject.Properties.Name -contains 'SampleNumberRuleTotal')) {
+            _KV -r $row -k '07 SampleNumberRules coverage' -v (("$($sum.SampleNumberRuleCovered)/$($sum.SampleNumberRuleTotal)")); $row++
+        }
+        # -----------------------------------------------
+
+        if ($qc.DistinctAssays.Count -gt 1) { _KV -r $row -k 'Varning: flera assay' -v ($qc.DistinctAssays -join ', '); $row++ }
+        if ($qc.DistinctAssayVersions.Count -gt 1) { _KV -r $row -k 'Varning: flera versioner' -v ($qc.DistinctAssayVersions -join ', '); $row++ }
+        if ($qc.DistinctReagentLots.Count -gt 1) { _KV -r $row -k 'Varning: flera reagent lots' -v ($qc.DistinctReagentLots -join ', '); $row++ }
+    }
+
+    # Pressure >= 90 summary (derived from rows to stay source-of-truth even if pressure rule changes)
+    $pressureGE90 = @($allRows | Where-Object {
+        $p = $null
+        try { $p = [double]$_.MaxPressure } catch { $p = $null }
+        return ($null -ne $p -and $p -ge 90)
+    }).Count
+    _KV -r $row -k 'Tryck ≥ 90 PSI' -v $pressureGE90; $row++
+
+    # Leave one blank row before table
     $row++
     $tableHeaderRow = $row
 
-    for ($c = 1; $c -le $headers.Count; $c++) {
-        $ws.Cells[$tableHeaderRow,$c].Value = $headers[$c-1]
-        $ws.Cells[$tableHeaderRow,$c].Style.Font.Bold = $true
-    }
-
-    $rows = $RuleEngineResult.Rows
-
-    # --- Exception-based filter (does NOT modify RuleEngineResult) ---
-    $rowsToWrite = $rows
+    # -------------------- Exception-only filter --------------------
+    $rowsToWrite = $allRows
     if (-not $IncludeAllRows) {
-        $rowsToWrite = @($rows | Where-Object {
-            $dev = (($_.Deviation + '')).Trim().ToUpperInvariant()
+        $rowsToWrite = @($allRows | Where-Object {
+            $dev = (($_.Deviation + '')).Trim()
             $hasDeviation = ($dev.Length -gt 0 -and $dev -ne 'OK')
 
             $obs = (($_.ObservedCall + '')).Trim().ToUpperInvariant()
@@ -1117,56 +1922,75 @@
         })
     }
 
+    # -------------------- Table header --------------------
+    for ($c=1; $c -le $headers.Count; $c++) {
+         $ws.Cells.Item($tableHeaderRow,$c).Value = $headers[$c-1]
+         $ws.Cells.Item($tableHeaderRow,$c).Style.Font.Bold = $true
+    }
+
+    try { $ws.Cells[$tableHeaderRow,1,$tableHeaderRow,$headers.Count].AutoFilter = $true } catch {}
+    try { $ws.View.FreezePanes($tableHeaderRow+1, 1) } catch {}
+
+    # If filtering yields nothing: keep header + deterministic message row
     if (-not $rowsToWrite -or $rowsToWrite.Count -eq 0) {
-        $ws.Cells[$tableHeaderRow+1,2].Value = 'No deviations found'
-        $ws.Cells[$tableHeaderRow+1,2].Style.Font.Italic = $true
-        try { if ($ws.Dimension) { $ws.Cells[$ws.Dimension.Address].AutoFitColumns() } } catch {}
-        return $ws
-    }
-
+        $ws.Cells.Item($tableHeaderRow+1,1).Value = 'No deviations found'
+        $ws.Cells.Item($tableHeaderRow+1,1).Style.Font.Italic = $true
+         try { if ($ws.Dimension) { $ws.Cells[$ws.Dimension.Address].AutoFitColumns() } } catch {}
+         return $ws
+     }
+
+    # -------------------- Write rows --------------------
     $rOut = $tableHeaderRow + 1
-    $idx = 1
+
+    function _SvDeviation([string]$d) {
+        $t = (($d + '')).Trim().ToUpperInvariant()
+        switch ($t) {
+            'OK' { return 'OK' }
+            'FP' { return 'Falskt positiv' }
+            'FN' { return 'Falskt negativ' }
+            'ERROR' { return 'Fel' }
+            'MISMATCH' { return 'Mismatch' }
+            'UNKNOWN' { return 'Okänt' }
+            default { return ($d + '') }
+        }
+    }
+
+    function _SvSuffixCheck([string]$s) {
+        $t = (($s + '')).Trim().ToUpperInvariant()
+        switch ($t) {
+            'OK' { return 'OK' }
+            'BAD' { return 'FEL' }
+            'MISSING' { return 'SAKNAS' }
+            default { return ($s + '') }
+        }
+    }
 
     foreach ($r in $rowsToWrite) {
-        $ws.Cells[$rOut,1].Value  = $idx
-        $ws.Cells[$rOut,2].Value  = ($r.SampleId + '')
-        $ws.Cells[$rOut,3].Value  = ($r.CartridgeSN + '')
-        $ws.Cells[$rOut,4].Value  = ($r.ModuleSN + '')
-        $ws.Cells[$rOut,5].Value  = ($r.StartTime + '')
-
-        $ws.Cells[$rOut,6].Value  = ($r.TestType + '')
-        $ws.Cells[$rOut,7].Value  = ($r.ExpectedTestType + '')
-        $ws.Cells[$rOut,8].Value  = ($r.ControlCode + '')
-
-        $ws.Cells[$rOut,9].Value  = ($r.SampleToken + '')
-        $ws.Cells[$rOut,10].Value = ($r.BaseToken + '')
-        $ws.Cells[$rOut,11].Value = ($r.ActualSuffix + '')
-        $ws.Cells[$rOut,12].Value = ($r.ExpectedSuffix + '')
-        $ws.Cells[$rOut,13].Value = ($r.SuffixCheck + '')
-        $ws.Cells[$rOut,14].Value = ($r.SuffixSource + '')
-
-        $ws.Cells[$rOut,15].Value = ($r.SampleNum + '')
-        $ws.Cells[$rOut,16].Value = ($r.SampleNumOK + '')
-        $ws.Cells[$rOut,17].Value = ($r.SampleNumWhy + '')
-
-        $ws.Cells[$rOut,18].Value = ($r.ExpectedCall + '')
-        $ws.Cells[$rOut,19].Value = ($r.ExpectedSource + '')
-        $ws.Cells[$rOut,20].Value = ($r.ObservedCall + '')
-        $ws.Cells[$rOut,21].Value = ($r.ObservedWhy + '')
-        $ws.Cells[$rOut,22].Value = ($r.Deviation + '')
-        $ws.Cells[$rOut,23].Value = ($r.RuleFlags + '')
-
-        $ws.Cells[$rOut,24].Value = ($r.Status + '')
-        $ws.Cells[$rOut,25].Value = ($r.ErrorCode + '')
-        $ws.Cells[$rOut,26].Value = ($r.ErrorName + '')
-        $ws.Cells[$rOut,27].Value = ($r.GeneratesRetest + '')
-        $ws.Cells[$rOut,28].Value = $(if ($null -ne $r.MaxPressure) { $r.MaxPressure } else { '' })
-        $ws.Cells[$rOut,29].Value = $(if ($r.PressureFlag) { 'YES' } else { '' })
-
-        $ws.Cells[$rOut,30].Value = ($r.TestResult + '')
-        $ws.Cells[$rOut,31].Value = ($r.ErrorText + '')
-
-        $rOut++; $idx++
+        $ws.Cells.Item($rOut,1).Value  = ($r.SampleId + '')
+        $ws.Cells.Item($rOut,2).Value  = ($r.ErrorCode + '')
+        $ws.Cells.Item($rOut,3).Value  = (_SvDeviation ($r.Deviation + ''))
+        $ws.Cells.Item($rOut,4).Value  = ($r.RuleFlags + '')
+        $ws.Cells.Item($rOut,5).Value  = ($r.ExpectedSuffix + '')
+        $ws.Cells.Item($rOut,6).Value  = (_SvSuffixCheck ($r.SuffixCheck + ''))
+        $ws.Cells.Item($rOut,7).Value  = ($r.CartridgeSN + '')
+        $ws.Cells.Item($rOut,8).Value  = ($r.ModuleSN + '')
+        $ws.Cells.Item($rOut,9).Value  = ($r.StartTime + '')
+        $ws.Cells.Item($rOut,10).Value = ($r.TestType + '')
+        $ws.Cells.Item($rOut,11).Value = ($r.ExpectedTestType + '')
+        $ws.Cells.Item($rOut,12).Value = ($r.ObservedWhy + '')
+        $ws.Cells.Item($rOut,13).Value = ($r.Status + '')
+        $ws.Cells.Item($rOut,14).Value = ($r.ErrorName + '')
+
+        $rt = (($r.GeneratesRetest + '')).Trim().ToUpperInvariant()
+        if ($rt -in @('YES','Y','TRUE','1')) { $ws.Cells.Item($rOut,15).Value = 'Ja' }
+        elseif ($rt) { $ws.Cells.Item($rOut,15).Value = 'Nej' }
+        else { $ws.Cells.Item($rOut,15).Value = '' }
+
+        $ws.Cells.Item($rOut,16).Value = $(if ($null -ne $r.MaxPressure) { $r.MaxPressure } else { '' })
+        $ws.Cells.Item($rOut,17).Value = ($r.TestResult + '')
+        $ws.Cells.Item($rOut,18).Value = ($r.ErrorText + '')
+
+        $rOut++
     }
 
     try { if ($ws.Dimension) { $ws.Cells[$ws.Dimension.Address].AutoFitColumns() } } catch {}
--- a/New folder/RuleBank/01_ResultCallPatterns.csv
+++ b/New folder/RuleBank/01_ResultCallPatterns.csv
@@ -1,188 +1,188 @@
-Assay,Call,MatchType,Pattern,Note,Enabled,Priority
-*,ERROR,EQUALS,ERROR,Generic: Test Result = ERROR,TRUE,9500
-*,ERROR,CONTAINS,NO RESULT,Generic: NO RESULT,TRUE,9500
-*,ERROR,CONTAINS,Aborted,,,
-*,ERROR,CONTAINS,INVALID,Generic: INVALID (non-HPV),TRUE,1000
-Xpert MTB-RIF Assay G4,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
-Xpert MTB-XDR,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
-Xpert MTB-RIF Ultra,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
-Xpert MTB-RIF JP IVD,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
-Xpert MTB-XDR,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
-Xpert MTB-RIF Ultra,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
-Xpert MTB-RIF JP IVD,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
-Xpert MTB-RIF Assay G4,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
-Xpert MTB-RIF Assay G4,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
-Xpert MTB-RIF Ultra,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
-Xpert MTB-RIF JP IVD,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
-Xpert MTB-XDR,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
-Xpert MRSA NxG,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
-Xpert MTB-RIF US IVD,NEG,EQUALS,MTB NOT DETECTED,Spec MTB SampleType 0,TRUE,9000
-Xpert HPV HR,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
-Xpert MTB-RIF Ultra,NEG,EQUALS,MTB NOT DETECTED,Spec MTB U SampleType 0,TRUE,9000
-Xpert HIV-1 Viral Load XC,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
-Xpert MTB-RIF Ultra,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ DETECTED,Spec MTB U SampleType 1 (wildcard),TRUE,9000
-Xpert MTB-RIF Ultra,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB U SampleType 2 (wildcard),TRUE,9000
-Xpert HPV HR,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
-Xpert MTB-XDR,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
-Xpert MTB-XDR,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
-Xpert HIV-1 Viral Load XC,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
-Xpert MTB-XDR,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
-Xpert HCV VL Fingerstick,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV FS SampleType 1 (wildcard),TRUE,9000
-Xpert Norovirus,POS,EQUALS,NORO GI DETECTED;NORO GII DETECTED,Spec NORO SampleType 1,TRUE,9000
-Xpert MTB-RIF US IVD,POS,EQUALS,MTB DETECTED;Rif Resistance NOT DETECTED,Spec MTB SampleType 1,TRUE,9000
-Xpert HPV v2 HR,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
-Xpert MTB-RIF JP IVD,NEG,EQUALS,MTB NOT DETECTED,Spec MTB JP SampleType 0,TRUE,9000
-Xpert MRSA_SA_BC_CE,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-Xpert MRSA-SA BC G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-Xpert MRSA-SA BC G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-Xpert MRSA-SA SSTI G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-Xpert MRSA-SA SSTI G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-Xpert MRSA_SA_BC,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-Xpert MRSA_SA_BC,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-Xpert MRSA_SA_BC_CE,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-Xpert MRSA NxG,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
-Xpert HPV v2 HR,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
-Xpert MTB-RIF Assay G4,NEG,EQUALS,MTB NOT DETECTED,Spec MTB SampleType 0,TRUE,9000
-Xpert SA Nasal Complete G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-Xpert MTB-RIF Assay G4,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB SampleType 1 (wildcard),TRUE,9000
-Xpert MTB-RIF JP IVD,POS,EQUALS,MTB DETECTED;Rif Resistance DETECTED,Spec MTB JP SampleType 2,TRUE,9000
-Xpert MTB-RIF JP IVD,POS,EQUALS,MTB DETECTED;Rif Resistance NOT DETECTED,Spec MTB JP SampleType 1,TRUE,9000
-Xpert Norovirus,NEG,EQUALS,NORO GI NOT DETECTED;NORO GII NOT DETECTED,Spec NORO SampleType 0,TRUE,9000
-Xpert SA Nasal Complete G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-Xpert HCV PQC,NEG,EQUALS,HCV NOT DETECTED,Spec GX HCV SampleType 0,TRUE,9000
-Xpert-C. difficile G2,NEG,EQUALS,Toxigenic C.diff NEGATIVE,Spec C.DIFF SampleType 0,TRUE,9000
-Xpert_Carba-R,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-Xpert_Carba-R,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-Xpert_HCV Viral Load,NEG,EQUALS,HCV NOT DETECTED,Spec HCV VL SampleType 0,TRUE,9000
-Xpert_HCV Viral Load,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV VL SampleType 1 (wildcard),TRUE,9000
-Xpert_HIV-1 Viral Load,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL SampleType 0,TRUE,9000
-Xpert_HIV-1 Viral Load,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL SampleType 1 (wildcard),TRUE,9000
-Xpress CoV-2 plus IUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
-Xpress CoV-2 plus IUO,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
-Xpress CoV-2 plus RUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
-Xpress CoV-2 plus RUO,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
-Xpress Flu IPT_EAT off,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
-Xpress Flu IPT_EAT off,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
-Xpress GBS IUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
-Xpress GBS IUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
-Xpress GBS RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
-Xpress GBS RUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
-Xpress SARS-CoV-2 Flu RSV plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
-Xpress SARS-CoV-2 Flu RSV plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
-Xpress SARS-CoV-2_Flu_RSV plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
-Xpert-C. difficile G2,POS,EQUALS,Toxigenic C.diff POSITIVE,Spec C.DIFF SampleType 1,TRUE,9000
-Xpert vanA vanB,POS,EQUALS,vanA POSITIVE;vanB POSITIVE,Spec VAN AB SampleType 1,TRUE,9000
-Xpert TAP Panel,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
-Xpert vanA vanB,NEG,EQUALS,vanA NEGATIVE;vanB NEGATIVE,Spec VAN AB SampleType 0,TRUE,9000
-Xpert TAP Panel,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
-Xpert Xpress CoV-2 plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
-Xpert Xpress CoV-2 plus,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
-Xpert Xpress CoV-2 plus IVD,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
-Xpert Xpress CoV-2 plus IVD,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
-Xpert Xpress Flu-RSV,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
-Xpert Xpress Flu-RSV,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
-Xpert Xpress GBS,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
-Xpert Xpress GBS,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
-Xpert Xpress GBS RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
-Xpert Xpress GBS RUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
-Xpert Xpress SARS-CoV-2,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Sars SampleType 0,TRUE,9000
-Xpert Xpress SARS-CoV-2,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Sars SampleType 1,TRUE,9000
-Xpert Xpress SARS-CoV-2 CE-IVD,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Sars SampleType 0,TRUE,9000
-Xpert Xpress SARS-CoV-2 CE-IVD,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Sars SampleType 1,TRUE,9000
-Xpert Xpress Strep A,POS,EQUALS,Strep A DETECTED,Spec STREPA SampleType 1,TRUE,9000
-Xpert Xpress Strep A,NEG,EQUALS,Strep A NOT DETECTED,Spec STREPA SampleType 0,TRUE,9000
-Xpert Xpress_Strep A,POS,EQUALS,Strep A DETECTED,Spec STREPA SampleType 1,TRUE,9000
-Xpert Xpress_Strep A,NEG,EQUALS,Strep A NOT DETECTED,Spec STREPA SampleType 0,TRUE,9000
-Xpert HCV VL Fingerstick,NEG,EQUALS,HCV NOT DETECTED,Spec HCV FS SampleType 0,TRUE,9000
-Xpert HCV PQC,POS,EQUALS,HCV DETECTED,Spec GX HCV SampleType 1,TRUE,9000
-MTB-XDR IUO,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
-LCE009 Xpress SARS-CoV-2 plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
-HCV Viral Load RUO,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV VL SampleType 1 (wildcard),TRUE,9000
-HIV-1 Viral Load RUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL SampleType 0,TRUE,9000
-HIV-1 Viral Load RUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL SampleType 1 (wildcard),TRUE,9000
-HIV-1 Viral Load XC IUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
-HIV-1 Viral Load XC IUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
-HIV-1 Viral Load XC RUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
-HIV-1 Viral Load XC RUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
-HPV HR AND GENOTYPE RUO ASSAY,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
-HPV HR AND GENOTYPE RUO ASSAY,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
-LCE009 Xpress SARS-CoV-2 plus,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
-Xpert HBV Viral Load,POS,REGEX,HBV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HBV VL SampleType 1 (wildcard),TRUE,9000
-MRSA NxG IUO,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
-MRSA NxG IUO,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
-MRSA NxG RUO,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
-MRSA NxG RUO,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
-MRSA-SA ETA,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
-MRSA-SA ETA,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
-MTB-RIF Ultra v2 RUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB U SampleType 0,TRUE,9000
-MTB-RIF Ultra v2 RUO,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ DETECTED,Spec MTB U SampleType 1 (wildcard),TRUE,9000
-MTB-RIF Ultra v2 RUO,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB U SampleType 2 (wildcard),TRUE,9000
-HCV Viral Load RUO,NEG,EQUALS,HCV NOT DETECTED,Spec HCV VL SampleType 0,TRUE,9000
-HCV VL WB RUO,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV FS SampleType 1 (wildcard),TRUE,9000
-HCV VL WB RUO,NEG,EQUALS,HCV NOT DETECTED,Spec HCV FS SampleType 0,TRUE,9000
-HCV IUO,NEG,EQUALS,HCV NOT DETECTED,Spec GX HCV SampleType 0,TRUE,9000
-CARBA-R IUO,POS,EQUALS,IMP1 DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-CARBA-R IUO,NEG,EQUALS,IMP1 NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-CARBA-R RUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-CARBA-R RUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-Carba-R BEU IUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-Carba-R BEU IUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-Carba-R BEU RUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-Carba-R BEU RUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-Ebola RUO,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
-Ebola RUO,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
-GBS LB RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
-GBS LB RUO,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
-GBS LB XC IUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
-GBS LB XC IUO,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
-GI Panel IUO,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
-GI Panel IUO,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
-GI Panel RUO,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
-GI Panel RUO,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
-HCV IUO,POS,EQUALS,HCV DETECTED,Spec GX HCV SampleType 1,TRUE,9000
-MTB-XDR IUO,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
-Xpress SARS-CoV-2_Flu_RSV plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
-MTB-XDR IUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
-Xpert C.difficile BT,NEG,EQUALS,Toxigenic C.diff NEG;Binary Toxin NEG;027 NEG,Spec C.DIFF SampleType 0,TRUE,9000
-Xpert C.difficile G3,NEG,EQUALS,Toxigenic C.diff NEGATIVE;027 PRESUMPTIVE NEG,Spec C.DIFF SampleType 0,TRUE,9000
-Xpert C.difficile G3,POS,EQUALS,Toxigenic C.diff POSITIVE;027 PRESUMPTIVE POS,Spec C.DIFF SampleType 1,TRUE,9000
-Xpert CT_CE,POS,EQUALS,CT DETECTED,Spec CTNG SampleType 1,TRUE,9000
-Xpert CT_CE,NEG,EQUALS,CT NOT DETECTED,Spec CTNG SampleType 0,TRUE,9000
-Xpert CT_NG,POS,EQUALS,CT DETECTED;NG DETECTED,Spec CTNG SampleType 1,TRUE,9000
-Xpert CT_NG,NEG,EQUALS,CT NOT DETECTED;NG NOT DETECTED,Spec CTNG SampleType 0,TRUE,9000
-Xpert Carba-R,POS,EQUALS,IMP1 DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
-Xpert Carba-R,NEG,EQUALS,IMP1 NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
-Xpert Ebola CE-IVD,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
-Xpert Ebola CE-IVD,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
-Xpert Ebola EUA,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
-Xpert Ebola EUA,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
-Xpert GBS LB XC,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
-Xpert GBS LB XC,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
-Xpert GI Panel,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
-Xpert GI Panel,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
-Xpert GI Panel CE-IVD,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
-Xpert GI Panel CE-IVD,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
-Xpert HBV Viral Load,NEG,EQUALS,HBV NOT DETECTED,Spec HBV VL SampleType 0,TRUE,9000
-Xpert C.difficile BT,POS,EQUALS,Toxigenic C.diff POS;Binary Toxin POS;027 PRESUMPTIVE POS,Spec C.DIFF SampleType 1,TRUE,9000
-Xpert C.diff-Epi,POS,EQUALS,Toxigenic C.diff POSITIVE;027 PRESUMPTIVE POSITIVE,Spec C.DIFF SampleType 1,TRUE,9000
-MTB-XDR RUO,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
-Xpert C.diff-Epi,NEG,EQUALS,Toxigenic C.diff NEGATIVE;027 PRESUMPTIVE NEGATIVE,Spec C.DIFF SampleType 0,TRUE,9000
-MTB-XDR RUO,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
-MTB-XDR RUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
-Respiratory Panel IUO,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
-Respiratory Panel RUO,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
-Respiratory panel,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
-Respiratory panel CE-IVD,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
-Respiratory panel UKCA-IVD,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
-SARS-CoV-2_Flu_RSV plus IUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
-SARS-CoV-2_Flu_RSV plus IUO,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
-SARS-CoV-2_Flu_RSV plus RUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
-SARS-CoV-2_Flu_RSV plus RUO,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
-SARS-CoV-2_Flu_RSV_plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
-SARS-CoV-2_Flu_RSV_plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
-TAP Panel IUO,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
-TAP Panel IUO,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
-TAP Panel RUO,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
-TAP Panel RUO,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
-XP Flu-RSV RUO,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
-XP Flu-RSV RUO,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
+Assay,Call,MatchType,Pattern,Note,Enabled,Priority
+*,ERROR,EQUALS,ERROR,Generic: Test Result = ERROR,TRUE,9500
+*,ERROR,CONTAINS,NO RESULT,Generic: NO RESULT,TRUE,9500
+*,ERROR,CONTAINS,Aborted,Generic: Aborted,TRUE,9500
+*,ERROR,CONTAINS,INVALID,Generic: INVALID (non-HPV),TRUE,1000
+Xpert MTB-RIF Assay G4,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
+Xpert MTB-XDR,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
+Xpert MTB-RIF Ultra,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
+Xpert MTB-RIF JP IVD,NEG,CONTAINS,MTB NOT DETECTED,MTB family: MTB NOT DETECTED => NEG,TRUE,9400
+Xpert MTB-XDR,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
+Xpert MTB-RIF Ultra,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
+Xpert MTB-RIF JP IVD,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
+Xpert MTB-RIF Assay G4,POS,CONTAINS,MTB Trace DETECTED,MTB family: MTB Trace DETECTED => POS (even if RIF indeterminate),TRUE,9390
+Xpert MTB-RIF Assay G4,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
+Xpert MTB-RIF Ultra,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
+Xpert MTB-RIF JP IVD,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
+Xpert MTB-XDR,POS,CONTAINS,MTB DETECTED,MTB family: MTB DETECTED => POS (covers HIGH/LOW; even if RIF indeterminate),TRUE,9380
+Xpert MRSA NxG,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
+Xpert MTB-RIF US IVD,NEG,EQUALS,MTB NOT DETECTED,Spec MTB SampleType 0,TRUE,9000
+Xpert HPV HR,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
+Xpert MTB-RIF Ultra,NEG,EQUALS,MTB NOT DETECTED,Spec MTB U SampleType 0,TRUE,9000
+Xpert HIV-1 Viral Load XC,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
+Xpert MTB-RIF Ultra,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ DETECTED,Spec MTB U SampleType 1 (wildcard),TRUE,9000
+Xpert MTB-RIF Ultra,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB U SampleType 2 (wildcard),TRUE,9000
+Xpert HPV HR,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
+Xpert MTB-XDR,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
+Xpert MTB-XDR,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
+Xpert HIV-1 Viral Load XC,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
+Xpert MTB-XDR,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
+Xpert HCV VL Fingerstick,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV FS SampleType 1 (wildcard),TRUE,9000
+Xpert Norovirus,POS,EQUALS,NORO GI DETECTED;NORO GII DETECTED,Spec NORO SampleType 1,TRUE,9000
+Xpert MTB-RIF US IVD,POS,EQUALS,MTB DETECTED;Rif Resistance NOT DETECTED,Spec MTB SampleType 1,TRUE,9000
+Xpert HPV v2 HR,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
+Xpert MTB-RIF JP IVD,NEG,EQUALS,MTB NOT DETECTED,Spec MTB JP SampleType 0,TRUE,9000
+Xpert MRSA_SA_BC_CE,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+Xpert MRSA-SA BC G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+Xpert MRSA-SA BC G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+Xpert MRSA-SA SSTI G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+Xpert MRSA-SA SSTI G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+Xpert MRSA_SA_BC,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+Xpert MRSA_SA_BC,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+Xpert MRSA_SA_BC_CE,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+Xpert MRSA NxG,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
+Xpert HPV v2 HR,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
+Xpert MTB-RIF Assay G4,NEG,EQUALS,MTB NOT DETECTED,Spec MTB SampleType 0,TRUE,9000
+Xpert SA Nasal Complete G3,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+Xpert MTB-RIF Assay G4,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB SampleType 1 (wildcard),TRUE,9000
+Xpert MTB-RIF JP IVD,POS,EQUALS,MTB DETECTED;Rif Resistance DETECTED,Spec MTB JP SampleType 2,TRUE,9000
+Xpert MTB-RIF JP IVD,POS,EQUALS,MTB DETECTED;Rif Resistance NOT DETECTED,Spec MTB JP SampleType 1,TRUE,9000
+Xpert Norovirus,NEG,EQUALS,NORO GI NOT DETECTED;NORO GII NOT DETECTED,Spec NORO SampleType 0,TRUE,9000
+Xpert SA Nasal Complete G3,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+Xpert HCV PQC,NEG,EQUALS,HCV NOT DETECTED,Spec GX HCV SampleType 0,TRUE,9000
+Xpert-C. difficile G2,NEG,EQUALS,Toxigenic C.diff NEGATIVE,Spec C.DIFF SampleType 0,TRUE,9000
+Xpert_Carba-R,POS,EQUALS,IMP1 DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+Xpert_Carba-R,NEG,EQUALS,IMP1 NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+Xpert_HCV Viral Load,NEG,EQUALS,HCV NOT DETECTED,Spec HCV VL SampleType 0,TRUE,9000
+Xpert_HCV Viral Load,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV VL SampleType 1 (wildcard),TRUE,9000
+Xpert_HIV-1 Viral Load,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL SampleType 0,TRUE,9000
+Xpert_HIV-1 Viral Load,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL SampleType 1 (wildcard),TRUE,9000
+Xpress CoV-2 plus IUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
+Xpress CoV-2 plus IUO,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
+Xpress CoV-2 plus RUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
+Xpress CoV-2 plus RUO,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
+Xpress Flu IPT_EAT off,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
+Xpress Flu IPT_EAT off,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
+Xpress GBS IUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
+Xpress GBS IUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
+Xpress GBS RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
+Xpress GBS RUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
+Xpress SARS-CoV-2 Flu RSV plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
+Xpress SARS-CoV-2 Flu RSV plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
+Xpress SARS-CoV-2_Flu_RSV plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
+Xpert-C. difficile G2,POS,EQUALS,Toxigenic C.diff POSITIVE,Spec C.DIFF SampleType 1,TRUE,9000
+Xpert vanA vanB,POS,EQUALS,vanA POSITIVE;vanB POSITIVE,Spec VAN AB SampleType 1,TRUE,9000
+Xpert TAP Panel,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
+Xpert vanA vanB,NEG,EQUALS,vanA NEGATIVE;vanB NEGATIVE,Spec VAN AB SampleType 0,TRUE,9000
+Xpert TAP Panel,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
+Xpert Xpress CoV-2 plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
+Xpert Xpress CoV-2 plus,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
+Xpert Xpress CoV-2 plus IVD,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
+Xpert Xpress CoV-2 plus IVD,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
+Xpert Xpress Flu-RSV,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
+Xpert Xpress Flu-RSV,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
+Xpert Xpress GBS,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
+Xpert Xpress GBS,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
+Xpert Xpress GBS RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS SampleType 0,TRUE,9000
+Xpert Xpress GBS RUO,POS,EQUALS,GBS POSITIVE,Spec GBS SampleType 1,TRUE,9000
+Xpert Xpress SARS-CoV-2,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Sars SampleType 0,TRUE,9000
+Xpert Xpress SARS-CoV-2,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Sars SampleType 1,TRUE,9000
+Xpert Xpress SARS-CoV-2 CE-IVD,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Sars SampleType 0,TRUE,9000
+Xpert Xpress SARS-CoV-2 CE-IVD,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Sars SampleType 1,TRUE,9000
+Xpert Xpress Strep A,POS,EQUALS,Strep A DETECTED,Spec STREPA SampleType 1,TRUE,9000
+Xpert Xpress Strep A,NEG,EQUALS,Strep A NOT DETECTED,Spec STREPA SampleType 0,TRUE,9000
+Xpert Xpress_Strep A,POS,EQUALS,Strep A DETECTED,Spec STREPA SampleType 1,TRUE,9000
+Xpert Xpress_Strep A,NEG,EQUALS,Strep A NOT DETECTED,Spec STREPA SampleType 0,TRUE,9000
+Xpert HCV VL Fingerstick,NEG,EQUALS,HCV NOT DETECTED,Spec HCV FS SampleType 0,TRUE,9000
+Xpert HCV PQC,POS,EQUALS,HCV DETECTED,Spec GX HCV SampleType 1,TRUE,9000
+MTB-XDR IUO,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
+LCE009 Xpress SARS-CoV-2 plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE,Spec Covid plus SampleType 0,TRUE,9000
+HCV Viral Load RUO,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV VL SampleType 1 (wildcard),TRUE,9000
+HIV-1 Viral Load RUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL SampleType 0,TRUE,9000
+HIV-1 Viral Load RUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL SampleType 1 (wildcard),TRUE,9000
+HIV-1 Viral Load XC IUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
+HIV-1 Viral Load XC IUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
+HIV-1 Viral Load XC RUO,NEG,EQUALS,HIV-1 NOT DETECTED,Spec HIV VL XC SampleType 0,TRUE,9000
+HIV-1 Viral Load XC RUO,POS,REGEX,HIV\-1\ DETECTED\ .*\ copies/mL\ \(log\ .*\..*\),Spec HIV VL XC SampleType 1 (wildcard),TRUE,9000
+HPV HR AND GENOTYPE RUO ASSAY,POS,EQUALS,HR HPV POS,Spec HPV SampleType 1,TRUE,9000
+HPV HR AND GENOTYPE RUO ASSAY,NEG,EQUALS,INVALID,Spec HPV SampleType 0,TRUE,9000
+LCE009 Xpress SARS-CoV-2 plus,POS,EQUALS,SARS-CoV-2 POSITIVE,Spec Covid plus SampleType 1,TRUE,9000
+Xpert HBV Viral Load,POS,REGEX,HBV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HBV VL SampleType 1 (wildcard),TRUE,9000
+MRSA NxG IUO,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
+MRSA NxG IUO,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
+MRSA NxG RUO,POS,EQUALS,MRSA DETECTED,Spec MRSA NxG SampleType 1,TRUE,9000
+MRSA NxG RUO,NEG,EQUALS,MRSA NOT DETECTED,Spec MRSA NxG SampleType 0,TRUE,9000
+MRSA-SA ETA,NEG,EQUALS,MRSA NEGATIVE;SA NEGATIVE,Spec MRSA SA SampleType 0,TRUE,9000
+MRSA-SA ETA,POS,EQUALS,MRSA POSITIVE;SA POSITIVE,Spec MRSA SA SampleType 1,TRUE,9000
+MTB-RIF Ultra v2 RUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB U SampleType 0,TRUE,9000
+MTB-RIF Ultra v2 RUO,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ DETECTED,Spec MTB U SampleType 1 (wildcard),TRUE,9000
+MTB-RIF Ultra v2 RUO,POS,REGEX,MTB\ DETECTED\ .*;Rif\ Resistance\ NOT\ DETECTED,Spec MTB U SampleType 2 (wildcard),TRUE,9000
+HCV Viral Load RUO,NEG,EQUALS,HCV NOT DETECTED,Spec HCV VL SampleType 0,TRUE,9000
+HCV VL WB RUO,POS,REGEX,HCV\ DETECTED\ .*\ IU/mL\ \(log\ .*\..*\),Spec HCV FS SampleType 1 (wildcard),TRUE,9000
+HCV VL WB RUO,NEG,EQUALS,HCV NOT DETECTED,Spec HCV FS SampleType 0,TRUE,9000
+HCV IUO,NEG,EQUALS,HCV NOT DETECTED,Spec GX HCV SampleType 0,TRUE,9000
+CARBA-R IUO,POS,EQUALS,IMP1 DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+CARBA-R IUO,NEG,EQUALS,IMP1 NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+CARBA-R RUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+CARBA-R RUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+Carba-R BEU IUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+Carba-R BEU IUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+Carba-R BEU RUO,POS,EQUALS,IMP DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+Carba-R BEU RUO,NEG,EQUALS,IMP NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+Ebola RUO,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
+Ebola RUO,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
+GBS LB RUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
+GBS LB RUO,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
+GBS LB XC IUO,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
+GBS LB XC IUO,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
+GI Panel IUO,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
+GI Panel IUO,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
+GI Panel RUO,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
+GI Panel RUO,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
+HCV IUO,POS,EQUALS,HCV DETECTED,Spec GX HCV SampleType 1,TRUE,9000
+MTB-XDR IUO,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
+Xpress SARS-CoV-2_Flu_RSV plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
+MTB-XDR IUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
+Xpert C.difficile BT,NEG,EQUALS,Toxigenic C.diff NEG;Binary Toxin NEG;027 NEG,Spec C.DIFF SampleType 0,TRUE,9000
+Xpert C.difficile G3,NEG,EQUALS,Toxigenic C.diff NEGATIVE;027 PRESUMPTIVE NEG,Spec C.DIFF SampleType 0,TRUE,9000
+Xpert C.difficile G3,POS,EQUALS,Toxigenic C.diff POSITIVE;027 PRESUMPTIVE POS,Spec C.DIFF SampleType 1,TRUE,9000
+Xpert CT_CE,POS,EQUALS,CT DETECTED,Spec CTNG SampleType 1,TRUE,9000
+Xpert CT_CE,NEG,EQUALS,CT NOT DETECTED,Spec CTNG SampleType 0,TRUE,9000
+Xpert CT_NG,POS,EQUALS,CT DETECTED;NG DETECTED,Spec CTNG SampleType 1,TRUE,9000
+Xpert CT_NG,NEG,EQUALS,CT NOT DETECTED;NG NOT DETECTED,Spec CTNG SampleType 0,TRUE,9000
+Xpert Carba-R,POS,EQUALS,IMP1 DETECTED;VIM DETECTED;NDM DETECTED;KPC DETECTED;OXA48 DETECTED,Spec CARBA SampleType 1,TRUE,9000
+Xpert Carba-R,NEG,EQUALS,IMP1 NOT DETECTED;VIM NOT DETECTED;NDM NOT DETECTED;KPC NOT DETECTED;OXA48 NOT DETECTED,Spec CARBA SampleType 0,TRUE,9000
+Xpert Ebola CE-IVD,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
+Xpert Ebola CE-IVD,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
+Xpert Ebola EUA,POS,EQUALS,Ebola GP DETECTED;Ebola NP DETECTED,Spec EBOLA SampleType 1,TRUE,9000
+Xpert Ebola EUA,NEG,EQUALS,Ebola GP NOT DETECTED;Ebola NP NOT DETECTED,Spec EBOLA SampleType 0,TRUE,9000
+Xpert GBS LB XC,NEG,EQUALS,GBS NEGATIVE,Spec GBS XC SampleType 0,TRUE,9000
+Xpert GBS LB XC,POS,EQUALS,GBS POSITIVE,Spec GBS XC SampleType 1,TRUE,9000
+Xpert GI Panel,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
+Xpert GI Panel,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
+Xpert GI Panel CE-IVD,NEG,EQUALS,Campylobacter NEGATIVE;Salmonella NEGATIVE;STEC stx1 NEGATIVE;STEC stx2 NEGATIVE;Shigella EIEC NEGATIVE;V. cholerae NEGATIVE;V. parahaemolyticus NEGATIVE;Yersinia NEGATIVE;Cryptosporidium NEGATIVE;Giardia NEGATIVE;Norovirus NEGATIVE,Spec GI Panel SampleType 0,TRUE,9000
+Xpert GI Panel CE-IVD,POS,EQUALS,Campylobacter POSITIVE;Salmonella POSITIVE;STEC stx1 POSITIVE;STEC stx2 POSITIVE;Shigella EIEC POSITIVE;V. cholerae POSITIVE;V. parahaemolyticus POSITIVE;Yersinia POSITIVE;Cryptosporidium POSITIVE;Giardia POSITIVE;Norovirus POSITIVE,Spec GI Panel SampleType 1,TRUE,9000
+Xpert HBV Viral Load,NEG,EQUALS,HBV NOT DETECTED,Spec HBV VL SampleType 0,TRUE,9000
+Xpert C.difficile BT,POS,EQUALS,Toxigenic C.diff POS;Binary Toxin POS;027 PRESUMPTIVE POS,Spec C.DIFF SampleType 1,TRUE,9000
+Xpert C.diff-Epi,POS,EQUALS,Toxigenic C.diff POSITIVE;027 PRESUMPTIVE POSITIVE,Spec C.DIFF SampleType 1,TRUE,9000
+MTB-XDR RUO,POS,EQUALS,MTB DETECTED;INH Resistance DETECTED;FLQ Resistance DETECTED;AMK Resistance DETECTED;KAN Resistance DETECTED;CAP Resistance DETECTED;ETH Resistance DETECTED,Spec MTB XDR SampleType 2,TRUE,9000
+Xpert C.diff-Epi,NEG,EQUALS,Toxigenic C.diff NEGATIVE;027 PRESUMPTIVE NEGATIVE,Spec C.DIFF SampleType 0,TRUE,9000
+MTB-XDR RUO,POS,EQUALS,MTB DETECTED;INH Resistance NOT DETECTED;FLQ Resistance NOT DETECTED;AMK Resistance NOT DETECTED;KAN Resistance NOT DETECTED;CAP Resistance NOT DETECTED;ETH Resistance NOT DETECTED,Spec MTB XDR SampleType 1,TRUE,9000
+MTB-XDR RUO,NEG,EQUALS,MTB NOT DETECTED,Spec MTB XDR SampleType 0,TRUE,9000
+Respiratory Panel IUO,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
+Respiratory Panel RUO,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
+Respiratory panel,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
+Respiratory panel CE-IVD,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
+Respiratory panel UKCA-IVD,NEG,EQUALS,Adenovirus NEGATIVE;Coronavirus NEGATIVE;SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;hMPV NEGATIVE;Parainfluenza NEGATIVE;Rhino-Enterovirus NEGATIVE;RSV NEGATIVE;B. parapertussis NEGATIVE;B. pertussis NEGATIVE;Chlam. pneumoniae NEGATIVE;Myco. pneumoniae NEGATIVE,Spec Respiratory Panel SampleType 0,TRUE,9000
+SARS-CoV-2_Flu_RSV plus IUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
+SARS-CoV-2_Flu_RSV plus IUO,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
+SARS-CoV-2_Flu_RSV plus RUO,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
+SARS-CoV-2_Flu_RSV plus RUO,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
+SARS-CoV-2_Flu_RSV_plus,NEG,EQUALS,SARS-CoV-2 NEGATIVE;Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLUVID plus SampleType 0,TRUE,9000
+SARS-CoV-2_Flu_RSV_plus,POS,EQUALS,SARS-CoV-2 POSITIVE;Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLUVID plus SampleType 1,TRUE,9000
+TAP Panel IUO,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
+TAP Panel IUO,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
+TAP Panel RUO,POS,EQUALS,Ft DETECTED;Ba DETECTED;Yp DETECTED,Spec TAP Panel SampleType 1,TRUE,9000
+TAP Panel RUO,NEG,EQUALS,Ft NOT DETECTED;Ba NOT DETECTED;Yp NOT DETECTED,Spec TAP Panel SampleType 0,TRUE,9000
+XP Flu-RSV RUO,NEG,EQUALS,Flu A NEGATIVE;Flu B NEGATIVE;RSV NEGATIVE,Spec FLU RSV SampleType 0,TRUE,9000
+XP Flu-RSV RUO,POS,EQUALS,Flu A POSITIVE;Flu B POSITIVE;RSV POSITIVE,Spec FLU RSV SampleType 1,TRUE,9000
--- a/New folder/RuleBank/07_SampleNumberRules.csv
+++ b/New folder/RuleBank/07_SampleNumberRules.csv
@@ -1,115 +1,106 @@
-AssayPattern,SampleTypeCode,SampleNumberTokenIndex,SampleNumberRegex,SampleNumberMin,SampleNumberMax,SampleNumberPad,Enabled,Note,Priority
-Xpert C.diff-Epi,0,3,^\d{2},1,10,2,TRUE,Spec C.DIFF: First 10 (Specimen) size=10 => 01-10,9000
-Xpert C.diff-Epi,0,3,^\d{2},11,110,2,TRUE,Spec C.DIFF: Negative (Specimen) size=100 => 11-110,9000
-Xpert C.diff-Epi,1,3,^\d{2},111,210,2,TRUE,Spec C.DIFF: Positive (Specimen) size=100 => 111-210,9000
-Xpert C.difficile G3,0,3,^\d{2},1,10,2,TRUE,Spec C.DIFF JP: First 10 (Specimen) size=10 => 01-10,9000
-Xpert C.difficile G3,0,3,^\d{2},11,110,2,TRUE,Spec C.DIFF JP: Negative (Specimen) size=100 => 11-110,9000
-Xpert C.difficile G3,1,3,^\d{2},111,180,2,TRUE,Spec C.DIFF JP: Medium Positive (Specimen) size=70 => 111-180,9000
-Xpert C.difficile G3,2,3,^\d{2},181,200,2,TRUE,Spec C.DIFF JP: Low Positive (Specimen) size=20 => 181-200,9000
-Xpert C.difficile G3,3,3,^\d{2},201,210,2,TRUE,Spec C.DIFF JP: High Positive (Specimen) size=10 => 201-210,9000
-CARBA-R IUO,0,3,^\d{2},1,10,2,TRUE,Spec CARBA: First 10 (Negative Control 1) size=10 => 01-10,9000
-CARBA-R IUO,0,3,^\d{2},11,150,2,TRUE,Spec CARBA: Negative (Negative Control 1) size=140 => 11-150,9000
-CARBA-R IUO,1,3,^\d{2},151,190,2,TRUE,Spec CARBA: Low Positive (Positive Control 1) size=40 => 151-190,9000
-CARBA-R IUO,2,3,^\d{2},191,210,2,TRUE,Spec CARBA: High Positive (Positive Control 2) size=20 => 191-210,9000
-Xpert Xpress SARS-CoV-2,0,3,^\d{2},1,10,2,TRUE,Spec Sars: First 10 (Negative Control 1) size=10 => 01-10,9000
-Xpert Xpress SARS-CoV-2,0,3,^\d{2},11,110,2,TRUE,Spec Sars: Negative (Negative Control 1) size=100 => 11-110,9000
-Xpert Xpress SARS-CoV-2,1,3,^\d{2},111,210,2,TRUE,Spec Sars: Positive (Positive Control 1) size=100 => 111-210,9000
-LCE009 Xpress SARS-CoV-2 plus,0,3,^\d{2},1,10,2,TRUE,Spec Covid plus: First 10 (Negative Control 1) size=10 => 01-10,9000
-LCE009 Xpress SARS-CoV-2 plus,0,3,^\d{2},11,110,2,TRUE,Spec Covid plus: Negative (Negative Control 1) size=100 => 11-110,9000
-LCE009 Xpress SARS-CoV-2 plus,1,3,^\d{2},111,210,2,TRUE,Spec Covid plus: Positive (Positive Control 1) size=100 => 111-210,9000
-SARS-CoV-2_Flu_RSV plus IUO,0,3,^\d{2},1,10,2,TRUE,Spec FLUVID plus: First 10 (Negative Control 1) size=10 => 01-10,9000
-SARS-CoV-2_Flu_RSV plus IUO,0,3,^\d{2},11,110,2,TRUE,Spec FLUVID plus: Negative (Negative Control 1) size=100 => 11-110,9000
-SARS-CoV-2_Flu_RSV plus IUO,1,3,^\d{2},111,210,2,TRUE,Spec FLUVID plus: Positive (Positive Control 1) size=100 => 111-210,9000
-Xpert CT_CE,0,3,^\d{2},1,10,2,TRUE,Spec CTNG: First 10 (Specimen) size=10 => 01-10,9000
-Xpert CT_CE,0,3,^\d{2},11,110,2,TRUE,Spec CTNG: Negative (Specimen) size=100 => 11-110,9000
-Xpert CT_CE,1,3,^\d{2},111,210,2,TRUE,Spec CTNG: Positive (Specimen) size=100 => 111-210,9000
-Ebola RUO,0,3,^\d{2},1,10,2,TRUE,Spec EBOLA: First 10 (Negative Control 1) size=10 => 01-10,9000
-Ebola RUO,0,3,^\d{2},11,110,2,TRUE,Spec EBOLA: Negative (Negative Control 1) size=100 => 11-110,9000
-Ebola RUO,1,3,^\d{2},111,190,2,TRUE,Spec EBOLA: Low Positive (Positive Control 1) size=80 => 111-190,9000
-Ebola RUO,2,3,^\d{2},191,210,2,TRUE,Spec EBOLA: High Positive (Positive Control 2) size=20 => 191-210,9000
-Xpert Xpress GBS,1,3,^\d{2},1,10,2,TRUE,Spec GBS: First 10 (Specimen) size=10 => 01-10,9000
-Xpert Xpress GBS,0,3,^\d{2},11,110,2,TRUE,Spec GBS: Negative (Specimen) size=100 => 11-110,9000
-Xpert Xpress GBS,1,3,^\d{2},111,210,2,TRUE,Spec GBS: Positive (Specimen) size=100 => 111-210,9000
-GBS LB RUO,1,3,^\d{2},1,10,2,TRUE,Spec GBS XC: First 10 (Specimen) size=10 => 01-10,9000
-GBS LB RUO,0,3,^\d{2},11,110,2,TRUE,Spec GBS XC: Negative (Specimen) size=100 => 11-110,9000
-GBS LB RUO,1,3,^\d{2},111,210,2,TRUE,Spec GBS XC: Positive (Specimen) size=100 => 111-210,9000
-GI Panel IUO,1,3,^\d{2},1,10,2,TRUE,Spec GI Panel: First 10 (Specimen) size=10 => 01-10,9000
-GI Panel IUO,0,3,^\d{2},11,110,2,TRUE,Spec GI Panel: Negative (Specimen) size=100 => 11-110,9000
-GI Panel IUO,1,3,^\d{2},111,210,2,TRUE,Spec GI Panel: Positive (Specimen) size=100 => 111-210,9000
-Xpert HBV Viral Load,1,3,^\d{2},1,10,2,TRUE,Spec HBV VL: First 10 (Positive Control 1) size=10 => 01-10,9000
-Xpert HBV Viral Load,0,3,^\d{2},11,110,2,TRUE,Spec HBV VL: Negative (Negative Control 1) size=100 => 11-110,9000
-Xpert HBV Viral Load,1,3,^\d{2},111,190,2,TRUE,Spec HBV VL: Low Positive (Positive Control 1) size=80 => 111-190,9000
-Xpert HBV Viral Load,2,3,^\d{2},191,210,2,TRUE,Spec HBV VL: High Positive (Positive Control 2) size=20 => 191-210,9000
-HCV VL WB RUO,1,3,^\d{2},1,10,2,TRUE,Spec HCV FS: First 10 (Positive Control 1) size=10 => 01-10,9000
-HCV VL WB RUO,0,3,^\d{2},11,110,2,TRUE,Spec HCV FS: Negative (Negative Control 1) size=100 => 11-110,9000
-HCV VL WB RUO,1,3,^\d{2},111,190,2,TRUE,Spec HCV FS: Low Positive (Positive Control 1) size=80 => 111-190,9000
-HCV VL WB RUO,2,3,^\d{2},191,210,2,TRUE,Spec HCV FS: High Positive (Positive Control 2) size=20 => 191-210,9000
-HCV IUO,1,3,^\d{2},1,10,2,TRUE,Spec GX HCV: First 10 (Positive Control 1) size=10 => 01-10,9000
-HCV IUO,0,3,^\d{2},11,110,2,TRUE,Spec GX HCV: Negative (Negative Control 1) size=100 => 11-110,9000
-HCV IUO,1,3,^\d{2},111,210,2,TRUE,Spec GX HCV: Positive (Positive Control 1) size=100 => 111-210,9000
-HCV Viral Load RUO,1,3,^\d{2},1,10,2,TRUE,Spec HCV VL: First 10 (Positive Control 1) size=10 => 01-10,9000
-HCV Viral Load RUO,0,3,^\d{2},11,110,2,TRUE,Spec HCV VL: Negative (Negative Control 1) size=100 => 11-110,9000
-HCV Viral Load RUO,1,3,^\d{2},111,190,2,TRUE,Spec HCV VL: Low Positive (Positive Control 1) size=80 => 111-190,9000
-HCV Viral Load RUO,2,3,^\d{2},191,210,2,TRUE,Spec HCV VL: High Positive (Positive Control 2) size=20 => 191-210,9000
-HIV-1 Viral Load RUO,1,3,^\d{2},1,10,2,TRUE,Spec HIV VL: First 10 (Positive Control 1) size=10 => 01-10,9000
-HIV-1 Viral Load RUO,0,3,^\d{2},11,110,2,TRUE,Spec HIV VL: Negative (Negative Control 1) size=100 => 11-110,9000
-HIV-1 Viral Load RUO,1,3,^\d{2},111,190,2,TRUE,Spec HIV VL: Low Positive (Positive Control 1) size=80 => 111-190,9000
-HIV-1 Viral Load RUO,2,3,^\d{2},191,210,2,TRUE,Spec HIV VL: High Positive (Positive Control 2) size=20 => 191-210,9000
-HIV-1 Viral Load XC IUO,1,3,^\d{2},1,10,2,TRUE,Spec HIV VL XC: First 10 (Positive Control 1) size=10 => 01-10,9000
-HIV-1 Viral Load XC IUO,0,3,^\d{2},11,110,2,TRUE,Spec HIV VL XC: Negative (Negative Control 1) size=100 => 11-110,9000
-HIV-1 Viral Load XC IUO,1,3,^\d{2},111,190,2,TRUE,Spec HIV VL XC: Low Positive (Positive Control 1) size=80 => 111-190,9000
-HIV-1 Viral Load XC IUO,2,3,^\d{2},191,210,2,TRUE,Spec HIV VL XC: High Positive (Positive Control 2) size=20 => 191-210,9000
-HPV HR AND GENOTYPE RUO ASSAY,1,3,^\d{2},1,10,2,TRUE,Spec HPV: First 10 (Positive Control 1) size=10 => 01-10,9000
-HPV HR AND GENOTYPE RUO ASSAY,0,3,^\d{2},11,70,2,TRUE,Spec HPV: Negative (Negative Control 1) size=60 => 11-70,9000
-HPV HR AND GENOTYPE RUO ASSAY,1,3,^\d{2},71,190,2,TRUE,Spec HPV: Low Positive (Positive Control 1) size=120 => 71-190,9000
-HPV HR AND GENOTYPE RUO ASSAY,2,3,^\d{2},191,210,2,TRUE,Spec HPV: High Positive (Positive Control 2) size=20 => 191-210,9000
-MRSA NxG IUO,0,3,^\d{2},1,10,2,TRUE,Spec MRSA NxG: First 10 (Negative Control 1) size=10 => 01-10,9000
-MRSA NxG IUO,0,3,^\d{2},11,110,2,TRUE,Spec MRSA NxG: Negative (Negative Control 1) size=100 => 11-110,9000
-MRSA NxG IUO,1,3,^\d{2},111,190,2,TRUE,Spec MRSA NxG: Low Positive (Positive Control 1) size=80 => 111-190,9000
-MRSA NxG IUO,2,3,^\d{2},191,210,2,TRUE,Spec MRSA NxG: High Positive (Positive Control 2) size=20 => 191-210,9000
-MRSA-SA ETA,0,3,^\d{2},1,10,2,TRUE,Spec MRSA SA: First 10 (Specimen) size=10 => 01-10,9000
-MRSA-SA ETA,0,3,^\d{2},11,110,2,TRUE,Spec MRSA SA: Negative (Specimen) size=100 => 11-110,9000
-MRSA-SA ETA,1,3,^\d{2},111,210,2,TRUE,Spec MRSA SA: Positive (Specimen) size=100 => 111-210,9000
-MTB-RIF Ultra v2 RUO,0,3,^\d{2},1,10,2,TRUE,Spec MTB U: First 10 (Negative Control 1) size=10 => 01-10,9000
-MTB-RIF Ultra v2 RUO,0,3,^\d{2},11,110,2,TRUE,Spec MTB U: Negative (Negative Control 1) size=100 => 11-110,9000
-MTB-RIF Ultra v2 RUO,1,3,^\d{2},111,190,2,TRUE,Spec MTB U: Positive (Positive Control 1) size=80 => 111-190,9000
-MTB-RIF Ultra v2 RUO,2,3,^\d{2},191,210,2,TRUE,Spec MTB U: TBWT (Positive Control 2) size=20 => 191-210,9000
-Xpert MTB-RIF Assay G4,0,3,^\d{2},1,10,2,TRUE,Spec MTB: First 10 (Specimen) size=10 => 01-10,9000
-Xpert MTB-RIF Assay G4,0,3,^\d{2},11,110,2,TRUE,Spec MTB: Negative (Specimen) size=100 => 11-110,9000
-Xpert MTB-RIF Assay G4,1,3,^\d{2},111,210,2,TRUE,Spec MTB: Positive (Specimen) size=100 => 111-210,9000
-Xpert MTB-RIF JP IVD,0,3,^\d{2},1,10,2,TRUE,Spec MTB JP: First 10 (Specimen) size=10 => 01-10,9000
-Xpert MTB-RIF JP IVD,0,3,^\d{2},11,110,2,TRUE,Spec MTB JP: Negative (Specimen) size=100 => 11-110,9000
-Xpert MTB-RIF JP IVD,1,3,^\d{2},111,170,2,TRUE,Spec MTB JP: TBWT (Specimen) size=60 => 111-170,9000
-Xpert MTB-RIF JP IVD,2,3,^\d{2},171,180,2,TRUE,Spec MTB JP: TBMDR1 Low (Specimen) size=10 => 171-180,9000
-Xpert MTB-RIF JP IVD,3,3,^\d{2},181,190,2,TRUE,Spec MTB JP: TBMDR1 High (Specimen) size=10 => 181-190,9000
-Xpert MTB-RIF JP IVD,4,3,^\d{2},191,200,2,TRUE,Spec MTB JP: TBMDR2 Low (Specimen) size=10 => 191-200,9000
-Xpert MTB-RIF JP IVD,5,3,^\d{2},201,210,2,TRUE,Spec MTB JP: TBMDR2 High (Specimen) size=10 => 201-210,9000
-MTB-XDR IUO,0,3,^\d{2},1,10,2,TRUE,Spec MTB XDR: First 10 (Negative Control 1) size=10 => 01-10,9000
-MTB-XDR IUO,0,3,^\d{2},11,110,2,TRUE,Spec MTB XDR: Negative (Negative Control 1) size=100 => 11-110,9000
-MTB-XDR IUO,1,3,^\d{2},111,190,2,TRUE,Spec MTB XDR: Low Positive (Positive Control 1) size=80 => 111-190,9000
-MTB-XDR IUO,2,3,^\d{2},191,210,2,TRUE,Spec MTB XDR: High Positive (Positive Control 2) size=20 => 191-210,9000
-Xpert Norovirus,0,3,^\d{2},1,10,2,TRUE,Spec NORO: First 10 (Negative Control 1) size=10 => 01-10,9000
-Xpert Norovirus,0,3,^\d{2},11,110,2,TRUE,Spec NORO: Negative (Negative Control 1) size=100 => 11-110,9000
-Xpert Norovirus,1,3,^\d{2},111,190,2,TRUE,Spec NORO: Low Positive (Positive Control 1) size=80 => 111-190,9000
-Xpert Norovirus,2,3,^\d{2},191,210,2,TRUE,Spec NORO: High Positive (Positive Control 2) size=20 => 191-210,9000
-Respiratory Panel IUO,0,3,^\d{2},1,10,2,TRUE,Spec Respiratory Panel: First 10 (Specimen) size=10 => 01-10,9000
-Respiratory Panel IUO,0,3,^\d{2},11,110,2,TRUE,Spec Respiratory Panel: Negative (Specimen) size=100 => 11-110,9000
-Respiratory Panel IUO,1,3,^\d{2},111,150,2,TRUE,Spec Respiratory Panel: Sample Mix 1 (Specimen) size=40 => 111-150,9000
-Respiratory Panel IUO,2,3,^\d{2},151,170,2,TRUE,Spec Respiratory Panel: Sample Mix 2 (Specimen) size=20 => 151-170,9000
-Respiratory Panel IUO,3,3,^\d{2},171,190,2,TRUE,Spec Respiratory Panel: Sample Mix 3 (Specimen) size=20 => 171-190,9000
-Respiratory Panel IUO,4,3,^\d{2},191,210,2,TRUE,Spec Respiratory Panel: Sample Mix 4 (Specimen) size=20 => 191-210,9000
-Xpert Xpress Strep A,0,3,^\d{2},1,10,2,TRUE,Spec STREPA: First 10 (Negative Control 1) size=10 => 01-10,9000
-Xpert Xpress Strep A,0,3,^\d{2},11,110,2,TRUE,Spec STREPA: Negative (Negative Control 1) size=100 => 11-110,9000
-Xpert Xpress Strep A,1,3,^\d{2},111,190,2,TRUE,Spec STREPA: Low Positive (Positive Control 1) size=80 => 111-190,9000
-Xpert Xpress Strep A,2,3,^\d{2},191,210,2,TRUE,Spec STREPA: High Positive (Positive Control 2) size=20 => 191-210,9000
-TAP Panel IUO,0,3,^\d{2},1,10,2,TRUE,Spec TAP Panel: First 10 (Negative Control 1) size=10 => 01-10,9000
-TAP Panel IUO,0,3,^\d{2},11,110,2,TRUE,Spec TAP Panel: Negative (Negative Control 1) size=100 => 11-110,9000
-TAP Panel IUO,1,3,^\d{2},111,210,2,TRUE,Spec TAP Panel: Positive (Positive Control 2) size=100 => 111-210,9000
-Xpert vanA vanB,0,3,^\d{2},1,10,2,TRUE,Spec VAN AB: First 10 (Negative Control 1) size=10 => 01-10,9000
-Xpert vanA vanB,0,3,^\d{2},11,110,2,TRUE,Spec VAN AB: Negative (Negative Control 1) size=100 => 11-110,9000
-Xpert vanA vanB,1,3,^\d{2},111,210,2,TRUE,Spec VAN AB: Positive (Positive Control 1) size=100 => 111-210,9000
-XP Flu-RSV RUO,0,3,^\d{2},1,10,2,TRUE,Spec FLU RSV: First 10 (Negative Control 1) size=10 => 01-10,9000
-XP Flu-RSV RUO,0,3,^\d{2},11,110,2,TRUE,Spec FLU RSV: Negative (Negative Control 1) size=100 => 11-110,9000
-XP Flu-RSV RUO,1,3,^\d{2},111,190,2,TRUE,Spec FLU RSV: Low Positive (Positive Control 1) size=80 => 111-190,9000
-XP Flu-RSV RUO,2,3,^\d{2},191,210,2,TRUE,Spec FLU RSV: High Positive (Positive Control 2) size=20 => 191-210,9000
-*,*,3,^\d{2},1,99,2,FALSE,"(Template) If an assay uses different sample-number ranges, add per-assay/per-code rules above.",100
+AssayPattern,SampleTypeCode,BagNoPattern,SampleNumberTokenIndex,SampleNumberRegex,SampleNumberMin,SampleNumberMax,SampleNumberPad,Enabled,Note,Priority
+Respiratory Panel IUO,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Respiratory Panel IUO,1,,3,^\d{2},11,14,2,TRUE,From AssayFam: bags=10 observed; range=11-14,9000
+Respiratory Panel IUO,2,,3,^\d{2},15,16,2,TRUE,From AssayFam: bags=10 observed; range=15-16,9000
+Respiratory Panel IUO,3,,3,^\d{2},17,18,2,TRUE,From AssayFam: bags=10 observed; range=17-18,9000
+Respiratory Panel IUO,4,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+TAP Panel IUO,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+TAP Panel IUO,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+TAP Panel IUO,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert C.difficile BT,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert C.difficile BT,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert C.difficile G3,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert C.difficile G3,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert C.difficile G3,2,,3,^\d{2},18,19,2,TRUE,From AssayFam: bags=10 observed; range=18-19,9000
+Xpert C.difficile G3,3,,3,^\d{2},20,20,2,TRUE,From AssayFam: bags=10 observed; range=20-20,9000
+Xpert CT_NG,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert CT_NG,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert CT_NG,2,,3,^\d{2},19,19,2,TRUE,From AssayFam: bags=10 observed; range=19-19,9000
+Xpert CT_NG,3,,3,^\d{2},20,20,2,TRUE,From AssayFam: bags=10 observed; range=20-20,9000
+Xpert Ebola EUA,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Ebola EUA,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert Ebola EUA,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert GBS LB XC,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert GBS LB XC,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+Xpert GBS LB XC,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert GI Panel,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert GI Panel,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+Xpert GI Panel,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HBV Viral Load,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert HBV Viral Load,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-18",9100
+Xpert HBV Viral Load,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HBV Viral Load,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert HCV PQC,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert HCV PQC,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+Xpert HCV PQC,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HCV VL Fingerstick,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert HCV VL Fingerstick,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-18",9100
+Xpert HCV VL Fingerstick,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HCV VL Fingerstick,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert HIV-1 Qual XC PQC,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert HIV-1 Qual XC PQC,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+Xpert HIV-1 Qual XC PQC,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HIV-1 Viral Load XC,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert HIV-1 Viral Load XC,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-18",9100
+Xpert HIV-1 Viral Load XC,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HIV-1 Viral Load XC,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert HPV HR,0,,3,^\d{2},1,6,2,TRUE,From AssayFam: bags=10 observed; range=01-06,9000
+Xpert HPV HR,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},7,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 07-18",9100
+Xpert HPV HR,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert HPV HR,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert MRSA NxG,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MRSA NxG,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert MRSA NxG,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert MRSA-SA SSTI G3,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MRSA-SA SSTI G3,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert MTB-RIF Assay G4,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MTB-RIF Assay G4,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert MTB-RIF JP IVD,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MTB-RIF JP IVD,1,,3,^\d{2},11,16,2,TRUE,From AssayFam: bags=10 observed; range=11-16,9000
+Xpert MTB-RIF JP IVD,2,,3,^\d{2},17,17,2,TRUE,From AssayFam: bags=10 observed; range=17-17,9000
+Xpert MTB-RIF JP IVD,3,,3,^\d{2},18,18,2,TRUE,From AssayFam: bags=10 observed; range=18-18,9000
+Xpert MTB-RIF JP IVD,4,,3,^\d{2},19,19,2,TRUE,From AssayFam: bags=10 observed; range=19-19,9000
+Xpert MTB-RIF JP IVD,5,,3,^\d{2},20,20,2,TRUE,From AssayFam: bags=10 observed; range=20-20,9000
+Xpert MTB-RIF Ultra,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MTB-RIF Ultra,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert MTB-RIF Ultra,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert MTB-XDR,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert MTB-XDR,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert MTB-XDR,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert Norovirus,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Norovirus,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert Norovirus,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert SA Nasal Complete G3,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert SA Nasal Complete G3,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert Xpress CoV-2 plus IVD,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Xpress CoV-2 plus IVD,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert Xpress Flu-RSV,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Xpress Flu-RSV,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert Xpress Flu-RSV,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert Xpress GBS,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert Xpress GBS,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,20,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-20",9100
+Xpert Xpress GBS,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert Xpress SARS-CoV-2 CE-IVD,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Xpress SARS-CoV-2 CE-IVD,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert Xpress Strep A,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert Xpress Strep A,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpert Xpress Strep A,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert vanA vanB,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpert vanA vanB,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
+Xpert_Carba-R,0,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},1,14,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 01-14",9100
+Xpert_Carba-R,0,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert_Carba-R,1,,3,^\d{2},15,18,2,TRUE,From AssayFam: bags=10 observed; range=15-18,9000
+Xpert_Carba-R,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert_HCV Viral Load,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert_HCV Viral Load,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-18",9100
+Xpert_HCV Viral Load,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert_HCV Viral Load,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpert_HIV-1 Viral Load,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=10 observed; range=01-10,9000
+Xpert_HIV-1 Viral Load,1,^(01|02|03|04|05|06|07|08|09|10)$,3,^\d{2},11,18,2,TRUE,"From AssayFam: bag(s) 01,02,03,04,05,06,07,08,09,10 -> 11-18",9100
+Xpert_HIV-1 Viral Load,1,^00$,3,^\d{2},1,10,2,TRUE,From AssayFam: bag(s) 00 -> 01-10,9100
+Xpert_HIV-1 Viral Load,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpress Flu IPT_EAT off,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpress Flu IPT_EAT off,1,,3,^\d{2},11,18,2,TRUE,From AssayFam: bags=10 observed; range=11-18,9000
+Xpress Flu IPT_EAT off,2,,3,^\d{2},19,20,2,TRUE,From AssayFam: bags=10 observed; range=19-20,9000
+Xpress SARS-CoV-2_Flu_RSV plus,0,,3,^\d{2},1,10,2,TRUE,From AssayFam: bags=11 observed; range=01-10,9000
+Xpress SARS-CoV-2_Flu_RSV plus,1,,3,^\d{2},11,20,2,TRUE,From AssayFam: bags=10 observed; range=11-20,9000
--- a/New folder/RuleBank/README.md
+++ b/New folder/RuleBank/README.md
@@ -14,4 +14,5 @@
 2. Lägg till expectations i 02_SampleExpectationRules.csv
 3. Lägg till markers i 05_SampleIdMarkers.csv (om behövs)
 4. Lägg till parity-config i 06_ParityCheckConfig.csv (om behövs)
-5. Lägg till sample-number-regler i 07_SampleNumberRules.csv
+5. Lägg till TestTypePolicy i 08_TestTypePolicy.csv
+6. Lägg till sample-number-regler i 07_SampleNumberRules.csv
