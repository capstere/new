--- /mnt/data/ps5_launcher_work/PS5Compiled/Launcher/Launcher.ps1.orig	2026-01-28 18:13:49.987119986 +0000
+++ /mnt/data/ps5_launcher_work/PS5Compiled/Launcher/Launcher.ps1	2026-01-28 18:18:27.436806471 +0000
@@ -2,7 +2,7 @@
 # Cache-first runner for IPTCompile
 #
 # Behavior:
-# 1) First run: copy project from network to C:\IPTCompile\app then run locally
+# 1) First run: copy project from network to C:\IPTCompile then run locally
 # 2) Subsequent runs: run locally directly; only recopy if Version.txt changed
 #
 # The launcher sets IPT_NETWORK_ROOT to the network project root so logs/audits
@@ -13,8 +13,7 @@
 
 # ----------------------------- Settings -----------------------------
 $AppName            = 'IPTCompile'
-$PreferredBase      = 'C:\IPTCompile'
-$CacheAppFolderName = 'app'
+$CacheRoot          = 'C:\IPTCompile'
 $AuditFolderName    = '_LauncherAudit'
 $VersionFileName    = 'Version.txt'
 $SourcePathFileName = 'SourcePath.txt'
@@ -166,15 +165,21 @@
 $auditDir = Join-Path $script:SourceRoot $AuditFolderName
 Write-Audit -AuditDir $auditDir -Level INFO -Message ('Launcher start. SourceRoot={0}' -f $script:SourceRoot)
 
-if (-not (Ensure-DirWritable -Path $PreferredBase)) {
-    Write-Audit -AuditDir $auditDir -Level ERROR -Message ('Could not create writable cache folder: {0}. Running from network.' -f $PreferredBase)
+if (-not (Ensure-DirWritable -Path $CacheRoot)) {
+    Write-Audit -AuditDir $auditDir -Level ERROR -Message ('Could not create writable cache folder: {0}. Running from network.' -f $CacheRoot)
     Run-Main -MainPath $mainNet
 }
 
-$dest  = Join-Path $PreferredBase $CacheAppFolderName
-$old   = Join-Path $PreferredBase 'app_old'
-$stage = Join-Path $PreferredBase '_staging'
-$rbLog = Join-Path $PreferredBase 'robocopy_last.log'
+# Cache root is the project root on C: (no \app subfolder)
+$dest  = $CacheRoot
+# Use sibling folders for robust staging + rollback (avoid half-copied cache)
+$old   = ($CacheRoot + '__old')
+$stage = ($CacheRoot + '__staging')
+
+# Keep robocopy log outside the cache (cache is swapped)
+$rbBase = Join-Path $env:TEMP ($AppName + '_Launcher')
+try { if (-not (Test-Path -LiteralPath $rbBase)) { New-Item -Path $rbBase -ItemType Directory -Force | Out-Null } } catch { }
+$rbLog = Join-Path $rbBase 'robocopy_last.log'
 
 # Guard against rundg√•ng
 try {
@@ -223,9 +228,17 @@
         Write-Audit -AuditDir $auditDir -Level INFO -Message ('Robocopy exit code={0} (0-7 OK, 8+ error). Log={1}' -f $rc, $rbLog)
 
         if ($rc -ge 8) {
-            Write-Audit -AuditDir $auditDir -Level ERROR -Message 'Robocopy failed. Running from network fallback.'
-            Safe-DeleteDir -Path $stage
-            Run-Main -MainPath $mainNet
+            # Prefer existing cache if present (avoid forcing slow network run on transient copy errors)
+            $localMain = Join-Path $dest 'Main.ps1'
+            if (Test-Path -LiteralPath $localMain) {
+                Write-Audit -AuditDir $auditDir -Level WARN -Message ("Robocopy failed (code=$rc). Using existing cache: $dest")
+                Safe-DeleteDir -Path $stage
+                Run-Main -MainPath $localMain
+            } else {
+                Write-Audit -AuditDir $auditDir -Level ERROR -Message ("Robocopy failed (code=$rc). No local cache found; running from network.")
+                Safe-DeleteDir -Path $stage
+                Run-Main -MainPath $mainNet
+            }
         }
 
         # Swap with rollback
